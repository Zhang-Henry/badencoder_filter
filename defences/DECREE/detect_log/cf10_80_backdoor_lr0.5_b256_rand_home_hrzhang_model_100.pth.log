Namespace(arch='resnet18', batch_size=256, encoder_path='/home/hrzhang/projects/badencoder_filter/output/cifar10/svhn_backdoored_encoder/2023-12-20-16:04:09/model_100.pth', encoder_usage_info='cifar10', gpu='5', id='_home_hrzhang_model_100.pth', lr=0.5, mask_init='rand', model_flag='backdoor', result_file='resultfinal_filter_txt.txt', seed=80, thres=0.99)
backdoor loaded: /home/hrzhang/projects/badencoder_filter/output/cifar10/svhn_backdoored_encoder/2023-12-20-16:04:09/model_100.pth
trigger: trigger/trigger_pt_white_21_10_ap_replace.npz
mask_size:32
shadow transform: Compose(
    Normalize(mean=[0.4914, 0.4822, 0.4465], std=[0.2023, 0.1994, 0.201])
)
shadow dataset size: 1000
Config: lambda_min: 1e-05, adapt_lambda: 5.0, lambda_set_patience: 10,succ_threshold: 0.99, early_stop_patience: 10,
epoch: 0  lr: 0.5000
e=0, loss=-0.047399, loss_cos=-0.905275, loss_reg=857.875670, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 1  lr: 0.5000
step1:loss_lambda is down to 0.0002
e=1, loss=-0.739049, loss_cos=-0.900426, loss_reg=267.545784, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 2  lr: 0.5000
step3:loss_lambda is down to 4e-05
e=2, loss=-0.893373, loss_cos=-0.963456, loss_reg=350.411723, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 3  lr: 0.5000
e=3, loss=-0.959801, loss_cos=-0.975096, loss_reg=382.390946, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 4  lr: 0.5000
step1:loss_lambda is down to 8.000000000000001e-06
e=4, loss=-0.973744, loss_cos=-0.984488, loss_reg=455.908521, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 5  lr: 0.5000
step3:loss_lambda is down to 8.000000000000001e-06
e=5, loss=-0.984463, loss_cos=-0.988553, loss_reg=511.278362, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 6  lr: 0.5000
e=6, loss=-0.986644, loss_cos=-0.991105, loss_reg=557.712384, cur_reg_best=553.542900, es_reg_best:553.542900
epoch: 7  lr: 0.5000
step2:loss_lambda is up to 4.000000000000001e-05
e=7, loss=-0.983057, loss_cos=-0.992537, loss_reg=588.569429, cur_reg_best=553.542900, es_reg_best:553.542900
epoch: 8  lr: 0.5000
e=8, loss=-0.970124, loss_cos=-0.992492, loss_reg=559.205323, cur_reg_best=536.990439, es_reg_best:536.990439
epoch: 9  lr: 0.5000
step0:loss_lambda is up to 0.00020000000000000004
e=9, loss=-0.914798, loss_cos=-0.985064, loss_reg=457.231531, cur_reg_best=523.606708, es_reg_best:523.606708
epoch: 10  lr: 0.5000
step3:loss_lambda is down to 4.000000000000001e-05
e=10, loss=-0.908503, loss_cos=-0.977147, loss_reg=343.218130, cur_reg_best=523.606708, es_reg_best:523.606708
epoch: 11  lr: 0.5000
e=11, loss=-0.969165, loss_cos=-0.986227, loss_reg=426.538251, cur_reg_best=494.532434, es_reg_best:494.532434
epoch: 12  lr: 0.5000
e=12, loss=-0.972337, loss_cos=-0.991724, loss_reg=484.687773, cur_reg_best=473.132755, es_reg_best:473.132755
epoch: 13  lr: 0.5000
step0:loss_lambda is up to 0.00020000000000000004
e=13, loss=-0.921524, loss_cos=-0.983337, loss_reg=403.680368, cur_reg_best=472.798187, es_reg_best:472.798187
epoch: 14  lr: 0.5000
step3:loss_lambda is down to 4.000000000000001e-05
e=14, loss=-0.912813, loss_cos=-0.978340, loss_reg=327.635462, cur_reg_best=472.798187, es_reg_best:472.798187
epoch: 15  lr: 0.5000
e=15, loss=-0.970852, loss_cos=-0.987503, loss_reg=416.266302, cur_reg_best=461.468831, es_reg_best:461.468831
epoch: 16  lr: 0.5000
step3:loss_lambda is up to 0.00020000000000000004
e=16, loss=-0.973703, loss_cos=-0.992229, loss_reg=463.152797, cur_reg_best=453.072373, es_reg_best:453.072373
epoch: 17  lr: 0.5000
e=17, loss=-0.910308, loss_cos=-0.981409, loss_reg=355.505325, cur_reg_best=453.072373, es_reg_best:453.072373
epoch: 18  lr: 0.5000
step2:loss_lambda is down to 4.000000000000001e-05
e=18, loss=-0.928953, loss_cos=-0.979075, loss_reg=311.492437, cur_reg_best=453.072373, es_reg_best:453.072373
epoch: 19  lr: 0.5000
e=19, loss=-0.973534, loss_cos=-0.991337, loss_reg=445.062325, cur_reg_best=453.072373, es_reg_best:453.072373
Early stop!
End:73.5192s
L1:453.0724:/home/hrzhang/projects/badencoder_filter/output/cifar10/svhn_backdoored_encoder/2023-12-20-16:04:09/model_100.pth:
reg: 857.88,267.55,350.41,382.39,455.91,511.28,557.71,588.57,559.21,457.23,343.22,426.54,484.69,403.68,327.64,416.27,463.15,355.51,311.49,445.06
cos: 0.91,0.9,0.96,0.98,0.98,0.99,0.99,0.99,0.99,0.99,0.98,0.99,0.99,0.98,0.98,0.99,0.99,0.98,0.98,0.99
