Namespace(arch='resnet18', batch_size=256, encoder_path='/home/hrzhang/projects/badencoder_filter/output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:31/model_125.pth', encoder_usage_info='cifar10', gpu='5', id='_home_hrzhang_model_125.pth', lr=0.5, mask_init='rand', model_flag='backdoor', result_file='resultfinal_filter_txt.txt', seed=80, thres=0.99)
backdoor loaded: /home/hrzhang/projects/badencoder_filter/output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:31/model_125.pth
trigger: trigger/trigger_pt_white_21_10_ap_replace.npz
mask_size:32
shadow transform: Compose(
    Normalize(mean=[0.4914, 0.4822, 0.4465], std=[0.2023, 0.1994, 0.201])
)
shadow dataset size: 1000
Config: lambda_min: 1e-05, adapt_lambda: 5.0, lambda_set_patience: 10,succ_threshold: 0.99, early_stop_patience: 10,
epoch: 0  lr: 0.5000
e=0, loss=-0.131466, loss_cos=-0.975060, loss_reg=843.593139, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 1  lr: 0.5000
step1:loss_lambda is down to 0.0002
e=1, loss=-0.870050, loss_cos=-0.965853, loss_reg=145.209782, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 2  lr: 0.5000
step3:loss_lambda is down to 4e-05
e=2, loss=-0.958245, loss_cos=-0.986414, loss_reg=140.841386, cur_reg_best=10000000.000000, es_reg_best:10000000.000000
epoch: 3  lr: 0.5000
e=3, loss=-0.984111, loss_cos=-0.990138, loss_reg=150.662782, cur_reg_best=158.477031, es_reg_best:158.477031
epoch: 4  lr: 0.5000
step3:loss_lambda is up to 0.0002
e=4, loss=-0.986271, loss_cos=-0.993484, loss_reg=180.323218, cur_reg_best=158.477031, es_reg_best:158.477031
epoch: 5  lr: 0.5000
e=5, loss=-0.961481, loss_cos=-0.990009, loss_reg=142.643562, cur_reg_best=150.184383, es_reg_best:150.184383
epoch: 6  lr: 0.5000
e=6, loss=-0.964695, loss_cos=-0.989663, loss_reg=124.837888, cur_reg_best=128.843309, es_reg_best:128.843309
epoch: 7  lr: 0.5000
e=7, loss=-0.965902, loss_cos=-0.989573, loss_reg=118.353190, cur_reg_best=121.832944, es_reg_best:121.832944
epoch: 8  lr: 0.5000
e=8, loss=-0.966262, loss_cos=-0.989502, loss_reg=116.197435, cur_reg_best=119.094731, es_reg_best:119.094731
epoch: 9  lr: 0.5000
e=9, loss=-0.966461, loss_cos=-0.989767, loss_reg=116.533583, cur_reg_best=117.221453, es_reg_best:117.221453
epoch: 10  lr: 0.5000
e=10, loss=-0.967201, loss_cos=-0.989145, loss_reg=109.722479, cur_reg_best=117.221453, es_reg_best:117.221453
epoch: 11  lr: 0.5000
e=11, loss=-0.968070, loss_cos=-0.989943, loss_reg=109.364364, cur_reg_best=104.008295, es_reg_best:104.008295
epoch: 12  lr: 0.5000
e=12, loss=-0.967685, loss_cos=-0.989855, loss_reg=110.854125, cur_reg_best=104.008295, es_reg_best:104.008295
epoch: 13  lr: 0.5000
e=13, loss=-0.968295, loss_cos=-0.989288, loss_reg=104.964049, cur_reg_best=104.008295, es_reg_best:104.008295
epoch: 14  lr: 0.5000
e=14, loss=-0.968542, loss_cos=-0.990272, loss_reg=108.648422, cur_reg_best=104.008295, es_reg_best:104.008295
Early stop!
End:86.5162s
L1:104.0083:/home/hrzhang/projects/badencoder_filter/output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:31/model_125.pth:
reg: 843.59,145.21,140.84,150.66,180.32,142.64,124.84,118.35,116.2,116.53,109.72,109.36,110.85,104.96,108.65
cos: 0.98,0.97,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99
