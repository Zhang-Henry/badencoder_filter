2024-02-24 21:05:20.705034: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-24 21:05:21.577522: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
cuda
--------------------------------------------------opt.target_label: 0
load C
load G
load M
Files already downloaded and verified
Files already downloaded and verified
 Eval:
0/40Acc Clean: 91.406 | Acc Bd: 99.609 | Acc Cross: 87.500
1/40Acc Clean: 92.578 | Acc Bd: 99.805 | Acc Cross: 88.086
2/40Acc Clean: 93.359 | Acc Bd: 99.609 | Acc Cross: 89.844
3/40Acc Clean: 93.262 | Acc Bd: 99.707 | Acc Cross: 89.355
4/40Acc Clean: 93.828 | Acc Bd: 99.531 | Acc Cross: 89.375
5/40Acc Clean: 93.555 | Acc Bd: 99.544 | Acc Cross: 89.258
6/40Acc Clean: 93.694 | Acc Bd: 99.609 | Acc Cross: 89.230
7/40Acc Clean: 93.896 | Acc Bd: 99.561 | Acc Cross: 89.355
8/40Acc Clean: 93.533 | Acc Bd: 99.566 | Acc Cross: 89.149
9/40Acc Clean: 93.477 | Acc Bd: 99.609 | Acc Cross: 89.414
10/40Acc Clean: 93.501 | Acc Bd: 99.609 | Acc Cross: 89.169
11/40Acc Clean: 93.587 | Acc Bd: 99.642 | Acc Cross: 89.290
12/40Acc Clean: 93.690 | Acc Bd: 99.639 | Acc Cross: 89.513
13/40Acc Clean: 93.666 | Acc Bd: 99.637 | Acc Cross: 89.453
14/40Acc Clean: 93.646 | Acc Bd: 99.635 | Acc Cross: 89.375
15/40Acc Clean: 93.506 | Acc Bd: 99.658 | Acc Cross: 89.331
16/40Acc Clean: 93.451 | Acc Bd: 99.655 | Acc Cross: 89.292
17/40Acc Clean: 93.468 | Acc Bd: 99.653 | Acc Cross: 89.258
18/40Acc Clean: 93.544 | Acc Bd: 99.671 | Acc Cross: 89.309
19/40Acc Clean: 93.594 | Acc Bd: 99.668 | Acc Cross: 89.395
20/40Acc Clean: 93.583 | Acc Bd: 99.684 | Acc Cross: 89.342
21/40Acc Clean: 93.626 | Acc Bd: 99.698 | Acc Cross: 89.382
22/40Acc Clean: 93.478 | Acc Bd: 99.711 | Acc Cross: 89.317
23/40Acc Clean: 93.490 | Acc Bd: 99.707 | Acc Cross: 89.339
24/40Acc Clean: 93.453 | Acc Bd: 99.703 | Acc Cross: 89.266
25/40Acc Clean: 93.344 | Acc Bd: 99.715 | Acc Cross: 89.213
26/40Acc Clean: 93.388 | Acc Bd: 99.725 | Acc Cross: 89.149
27/40Acc Clean: 93.429 | Acc Bd: 99.721 | Acc Cross: 89.132
28/40Acc Clean: 93.413 | Acc Bd: 99.704 | Acc Cross: 89.009
29/40Acc Clean: 93.424 | Acc Bd: 99.714 | Acc Cross: 89.010
30/40Acc Clean: 93.435 | Acc Bd: 99.710 | Acc Cross: 88.974
31/40Acc Clean: 93.555 | Acc Bd: 99.719 | Acc Cross: 89.087
32/40Acc Clean: 93.525 | Acc Bd: 99.716 | Acc Cross: 89.039
33/40Acc Clean: 93.589 | Acc Bd: 99.724 | Acc Cross: 89.062
34/40Acc Clean: 93.683 | Acc Bd: 99.732 | Acc Cross: 89.185
35/40Acc Clean: 93.707 | Acc Bd: 99.740 | Acc Cross: 89.193
36/40Acc Clean: 93.718 | Acc Bd: 99.736 | Acc Cross: 89.179
37/40Acc Clean: 93.843 | Acc Bd: 99.743 | Acc Cross: 89.330
38/40Acc Clean: 93.790 | Acc Bd: 99.750 | Acc Cross: 89.303
39/40Acc Clean: 93.800 | Acc Bd: 99.750 | Acc Cross: 89.320
*****class:0*****
percentile_95:0.22107408940792084
percentile_99:0.42169252038002014
percentile_95:[0.00783685],TP95:0.8
percentile_99:[0.01204298],TP99:0.56
false_negetive_95:500,false_negetive_99:500
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:1*****
percentile_95:0.011883190833032131
percentile_99:0.013899615965783596
false_negetive_95:0,false_negetive_99:0
false_positive_95:8,false_positive_99：7
[tensor(1.2204, device='cuda:0'), tensor(2.4409, device='cuda:0')]
KMMD:1.671586513519287.
*****class:2*****
percentile_95:0.015630550682544708
percentile_99:0.029889648780226707
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:3*****
percentile_95:0.017863189801573753
percentile_99:0.019711731001734734
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：1
[tensor(1.3882, device='cuda:0'), tensor(2.7763, device='cuda:0')]
KMMD:2.0128369331359863.
*****class:4*****
percentile_95:0.023951848968863487
percentile_99:0.027669614180922508
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：0
[tensor(1.3844, device='cuda:0'), tensor(2.7687, device='cuda:0')]
KMMD:1.7200398445129395.
*****class:5*****
percentile_95:0.0209419634193182
percentile_99:0.022276315838098526
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：0
[tensor(1.3372, device='cuda:0'), tensor(2.6744, device='cuda:0')]
KMMD:1.5933091640472412.
*****class:6*****
percentile_95:0.024613844230771065
percentile_99:0.02553914114832878
false_negetive_95:0,false_negetive_99:0
false_positive_95:7,false_positive_99：7
[tensor(1.2329, device='cuda:0'), tensor(2.4659, device='cuda:0')]
KMMD:1.619019627571106.
*****class:7*****
percentile_95:0.02803482674062252
percentile_99:0.03164041042327881
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:8*****
percentile_95:0.01735600270330906
percentile_99:0.06949717551469803
false_negetive_95:0,false_negetive_99:0
false_positive_95:20,false_positive_99：8
[tensor(1.2315, device='cuda:0'), tensor(2.4629, device='cuda:0')]
KMMD:2.447519302368164.
*****class:9*****
percentile_95:0.0512506440281868
percentile_99:0.1256297081708908
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
[0.0, 1.671586513519287, 0.0, 2.0128369331359863, 1.7200398445129395, 1.5933091640472412, 1.619019627571106, 0.0, 2.447519302368164, 0.0]
1.74
0.07
1.74
0.44
0.12
0.01
0.01
1.74
0.91
1.74
cuda
--------------------------------------------------opt.target_label: 1
load C
load G
load M
Files already downloaded and verified
Files already downloaded and verified
 Eval:
0/40Acc Clean: 93.359 | Acc Bd: 100.000 | Acc Cross: 88.672
1/40Acc Clean: 93.750 | Acc Bd: 99.609 | Acc Cross: 88.672
2/40Acc Clean: 94.141 | Acc Bd: 99.349 | Acc Cross: 88.281
3/40Acc Clean: 93.750 | Acc Bd: 99.316 | Acc Cross: 88.574
4/40Acc Clean: 93.438 | Acc Bd: 99.062 | Acc Cross: 88.516
5/40Acc Clean: 93.750 | Acc Bd: 99.023 | Acc Cross: 88.346
6/40Acc Clean: 93.862 | Acc Bd: 98.996 | Acc Cross: 88.672
7/40Acc Clean: 93.555 | Acc Bd: 98.877 | Acc Cross: 88.232
8/40Acc Clean: 93.316 | Acc Bd: 98.915 | Acc Cross: 87.891
9/40Acc Clean: 93.164 | Acc Bd: 98.984 | Acc Cross: 87.891
10/40Acc Clean: 93.395 | Acc Bd: 99.006 | Acc Cross: 88.104
11/40Acc Clean: 93.359 | Acc Bd: 99.023 | Acc Cross: 88.086
12/40Acc Clean: 93.239 | Acc Bd: 99.038 | Acc Cross: 88.071
13/40Acc Clean: 93.220 | Acc Bd: 99.079 | Acc Cross: 87.863
14/40Acc Clean: 93.385 | Acc Bd: 99.063 | Acc Cross: 88.047
15/40Acc Clean: 93.408 | Acc Bd: 99.121 | Acc Cross: 88.037
16/40Acc Clean: 93.336 | Acc Bd: 99.127 | Acc Cross: 88.074
17/40Acc Clean: 93.359 | Acc Bd: 99.132 | Acc Cross: 87.869
18/40Acc Clean: 93.359 | Acc Bd: 99.095 | Acc Cross: 87.850
19/40Acc Clean: 93.398 | Acc Bd: 99.102 | Acc Cross: 87.773
20/40Acc Clean: 93.452 | Acc Bd: 99.089 | Acc Cross: 87.946
21/40Acc Clean: 93.501 | Acc Bd: 99.041 | Acc Cross: 88.015
22/40Acc Clean: 93.478 | Acc Bd: 99.032 | Acc Cross: 88.111
23/40Acc Clean: 93.392 | Acc Bd: 99.056 | Acc Cross: 87.972
24/40Acc Clean: 93.422 | Acc Bd: 99.047 | Acc Cross: 87.969
25/40Acc Clean: 93.450 | Acc Bd: 99.069 | Acc Cross: 87.936
26/40Acc Clean: 93.475 | Acc Bd: 99.045 | Acc Cross: 87.992
27/40Acc Clean: 93.513 | Acc Bd: 99.051 | Acc Cross: 88.030
28/40Acc Clean: 93.575 | Acc Bd: 99.071 | Acc Cross: 88.039
29/40Acc Clean: 93.542 | Acc Bd: 99.089 | Acc Cross: 88.086
30/40Acc Clean: 93.586 | Acc Bd: 99.080 | Acc Cross: 88.092
31/40Acc Clean: 93.579 | Acc Bd: 99.036 | Acc Cross: 87.988
32/40Acc Clean: 93.608 | Acc Bd: 99.053 | Acc Cross: 88.021
33/40Acc Clean: 93.601 | Acc Bd: 99.081 | Acc Cross: 88.006
34/40Acc Clean: 93.571 | Acc Bd: 99.074 | Acc Cross: 87.991
35/40Acc Clean: 93.544 | Acc Bd: 99.089 | Acc Cross: 88.010
36/40Acc Clean: 93.549 | Acc Bd: 99.071 | Acc Cross: 87.965
37/40Acc Clean: 93.534 | Acc Bd: 99.065 | Acc Cross: 87.880
38/40Acc Clean: 93.550 | Acc Bd: 99.058 | Acc Cross: 87.851
39/40Acc Clean: 93.550 | Acc Bd: 99.060 | Acc Cross: 87.860
*****class:0*****
percentile_95:0.013211174868047237
percentile_99:0.02455512434244156
false_negetive_95:0,false_negetive_99:0
false_positive_95:5,false_positive_99：0
[tensor(2.2863, device='cuda:0'), tensor(4.5726, device='cuda:0')]
KMMD:1.9674315452575684.
*****class:1*****
percentile_95:0.015327605418860912
percentile_99:0.02232682704925537
percentile_95:[0.00417791],TP95:0.566
percentile_99:[0.0058695],TP99:0.292
false_negetive_95:498,false_negetive_99:500
false_positive_95:0,false_positive_99：0
[tensor(2.3375, device='cuda:0'), tensor(4.6750, device='cuda:0')]
KMMD:2.1407761573791504.
*****class:2*****
percentile_95:0.01799640618264675
percentile_99:0.03664436936378479
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:3*****
percentile_95:0.017174964770674706
percentile_99:0.01902577467262745
false_negetive_95:0,false_negetive_99:0
false_positive_95:7,false_positive_99：4
[tensor(2.0949, device='cuda:0'), tensor(4.1899, device='cuda:0')]
KMMD:1.7486424446105957.
*****class:4*****
percentile_95:0.01832703873515129
percentile_99:0.03609196096658707
false_negetive_95:0,false_negetive_99:0
false_positive_95:39,false_positive_99：3
[tensor(2.1653, device='cuda:0'), tensor(4.3307, device='cuda:0')]
KMMD:3.6892471313476562.
*****class:5*****
percentile_95:0.01210448332130909
percentile_99:0.01753144897520542
false_negetive_95:0,false_negetive_99:0
false_positive_95:5,false_positive_99：2
[tensor(2.0076, device='cuda:0'), tensor(4.0152, device='cuda:0')]
KMMD:2.2344746589660645.
*****class:6*****
percentile_95:0.016529886052012444
percentile_99:0.01936884969472885
false_negetive_95:0,false_negetive_99:0
false_positive_95:14,false_positive_99：8
[tensor(1.8987, device='cuda:0'), tensor(3.7974, device='cuda:0')]
KMMD:3.4529709815979004.
*****class:7*****
percentile_95:0.016877517104148865
percentile_99:0.026178451254963875
false_negetive_95:0,false_negetive_99:0
false_positive_95:36,false_positive_99：35
[tensor(2.0278, device='cuda:0'), tensor(4.0556, device='cuda:0')]
KMMD:3.721639633178711.
*****class:8*****
percentile_95:0.009200314991176128
percentile_99:0.015566039830446243
false_negetive_95:0,false_negetive_99:0
false_positive_95:8,false_positive_99：3
[tensor(1.8397, device='cuda:0'), tensor(3.6793, device='cuda:0')]
KMMD:2.7743191719055176.
*****class:9*****
percentile_95:0.011143229901790619
percentile_99:0.017529143020510674
false_negetive_95:0,false_negetive_99:0
false_positive_95:16,false_positive_99：10
[tensor(1.6207, device='cuda:0'), tensor(3.2415, device='cuda:0')]
KMMD:1.4886059761047363.
[1.9674315452575684, 2.1407761573791504, 0.0, 1.7486424446105957, 3.6892471313476562, 2.2344746589660645, 3.4529709815979004, 3.721639633178711, 2.7743191719055176, 1.4886059761047363]
0.23
0.05
2.30
0.46
1.58
0.05
1.33
1.61
0.62
0.73
cuda
--------------------------------------------------opt.target_label: 2
Traceback (most recent call last):
  File "Beatrix.py", line 559, in <module>
    main(k)
  File "Beatrix.py", line 551, in main
    data = train(opt)
  File "Beatrix.py", line 182, in train
    state_dict = torch.load(ckpt_path,map_location=opt.device)
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 791, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 271, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 252, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '../../checkpoints/cifar10/all2one/target_2/all2one_cifar10_ckpt.pth.tar'
