/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
2024-03-01 23:23:08.049887: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 23:23:08.849192: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
cuda
--------------------------------------------------opt.target_label: 0
load C
 Eval:
0/791/792/793/794/795/796/797/798/799/7910/79*****class:0*****
percentile_95:0.01609574817121029
percentile_99:0.02461673691868782
percentile_95:[0.0038285],TP95:0.316
percentile_99:[0.00706293],TP99:0.122
false_negetive_95:482,false_negetive_99:495
false_positive_95:0,false_positive_99：0
[tensor(1.7903, device='cuda:0', grad_fn=<MulBackward0>), tensor(3.5806, device='cuda:0', grad_fn=<MulBackward0>)]
KMMD:3.6232383251190186.
*****class:1*****
percentile_95:0.034952349960803986
percentile_99:0.044016554951667786
false_negetive_95:0,false_negetive_99:0
false_positive_95:10,false_positive_99：6
[tensor(1.3556, device='cuda:0'), tensor(2.7112, device='cuda:0')]
KMMD:1.9020544290542603.
*****class:2*****
percentile_95:0.007625378668308258
percentile_99:0.05611028894782066
false_negetive_95:0,false_negetive_99:0
false_positive_95:5,false_positive_99：0
[tensor(1.8825, device='cuda:0'), tensor(3.7649, device='cuda:0')]
KMMD:2.112985372543335.
*****class:3*****
percentile_95:0.017106758430600166
percentile_99:0.01733340695500374
false_negetive_95:0,false_negetive_99:0
false_positive_95:3,false_positive_99：3
[tensor(1.4917, device='cuda:0'), tensor(2.9835, device='cuda:0')]
KMMD:1.1621246337890625.
*****class:4*****
percentile_95:0.019261397421360016
percentile_99:0.02447752095758915
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:5*****
percentile_95:0.01419009454548359
percentile_99:0.01676121912896633
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:6*****
percentile_95:0.013339929282665253
percentile_99:0.02201046049594879
false_negetive_95:0,false_negetive_99:0
false_positive_95:4,false_positive_99：0
[tensor(1.3851, device='cuda:0'), tensor(2.7703, device='cuda:0')]
KMMD:1.5856239795684814.
*****class:7*****
percentile_95:0.0759984627366066
percentile_99:0.13181069493293762
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:8*****
percentile_95:0.023418476805090904
percentile_99:0.06527522206306458
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:9*****
percentile_95:0.04522870108485222
percentile_99:1.0684213638305664
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：0
[tensor(1.1659, device='cuda:0'), tensor(2.3319, device='cuda:0')]
KMMD:1.4832334518432617.
[3.6232383251190186, 1.9020544290542603, 2.112985372543335, 1.1621246337890625, 0.0, 0.0, 1.5856239795684814, 0.0, 0.0, 1.4832334518432617]
1.47
0.37
0.50
0.10
0.84
0.84
0.17
0.84
0.84
0.10
cuda
--------------------------------------------------opt.target_label: 1
load C
 Eval:
0/791/792/793/794/795/796/797/798/799/7910/79*****class:0*****
percentile_95:0.014928873628377914
percentile_99:0.17842964828014374
false_negetive_95:0,false_negetive_99:0
false_positive_95:3,false_positive_99：0
[tensor(1.7325, device='cuda:0'), tensor(3.4650, device='cuda:0')]
KMMD:2.354720115661621.
*****class:1*****
percentile_95:0.054025981575250626
percentile_99:0.05816563218832016
percentile_95:[0.0045571],TP95:0.108
percentile_99:[0.00741602],TP99:0.012
false_negetive_95:500,false_negetive_99:500
false_positive_95:0,false_positive_99：0
KMMD:0.0.
*****class:2*****
percentile_95:0.009547745808959007
percentile_99:0.014742852188646793
false_negetive_95:0,false_negetive_99:0
false_positive_95:7,false_positive_99：5
[tensor(1.7740, device='cuda:0'), tensor(3.5480, device='cuda:0')]
KMMD:2.264420747756958.
*****class:3*****
percentile_95:0.01112523302435875
percentile_99:0.018174121156334877
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：1
[tensor(1.5001, device='cuda:0'), tensor(3.0002, device='cuda:0')]
KMMD:2.2588424682617188.
*****class:4*****
percentile_95:0.008925612084567547
percentile_99:0.02437279373407364
false_negetive_95:0,false_negetive_99:0
false_positive_95:2,false_positive_99：2
[tensor(1.5356, device='cuda:0'), tensor(3.0713, device='cuda:0')]
KMMD:1.6751288175582886.
*****class:5*****
percentile_95:0.016081372275948524
percentile_99:0.02662005089223385
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：0
[tensor(1.4594, device='cuda:0'), tensor(2.9188, device='cuda:0')]
KMMD:2.0682947635650635.
*****class:6*****
percentile_95:0.02346494048833847
percentile_99:0.04338627681136131
false_negetive_95:0,false_negetive_99:0
false_positive_95:1,false_positive_99：0
[tensor(1.3064, device='cuda:0'), tensor(2.6128, device='cuda:0')]
KMMD:2.0289719104766846.
*****class:7*****
percentile_95:0.015565726906061172
percentile_99:0.016211748123168945
false_negetive_95:0,false_negetive_99:0
false_positive_95:2,false_positive_99：2
[tensor(1.3580, device='cuda:0'), tensor(2.7161, device='cuda:0')]
KMMD:1.4649510383605957.
*****class:8*****
percentile_95:0.018281444907188416
percentile_99:0.04615595564246178
false_negetive_95:0,false_negetive_99:0
false_positive_95:3,false_positive_99：1
[tensor(1.3920, device='cuda:0'), tensor(2.7840, device='cuda:0')]
KMMD:1.5258976221084595.
*****class:9*****
percentile_95:0.1125684529542923
percentile_99:0.20743298530578613
false_negetive_95:0,false_negetive_99:0
false_positive_95:0,false_positive_99：0
KMMD:0.0.
[2.354720115661621, 0.0, 2.264420747756958, 2.2588424682617188, 1.6751288175582886, 2.0682947635650635, 2.0289719104766846, 1.4649510383605957, 1.5258976221084595, 0.0]
0.85
3.15
0.70
0.69
0.30
0.37
0.30
0.66
0.55
3.15
cuda
--------------------------------------------------opt.target_label: 2
Traceback (most recent call last):
  File "Beatrix_ours.py", line 560, in <module>
    main(k)
  File "Beatrix_ours.py", line 551, in main
    data = train(opt)
  File "Beatrix_ours.py", line 181, in train
    state_dict = torch.load(ckpt_path,map_location=opt.device)
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 791, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 271, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torch/serialization.py", line 252, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '../../checkpoints/cifar10/all2one/target_2/all2one_cifar10_ckpt.pth.tar'
