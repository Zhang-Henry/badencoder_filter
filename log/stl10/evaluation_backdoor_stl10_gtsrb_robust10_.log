transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-06 20:01:35
当前时间： 2024-01-06 20:01:36
test_transform_stl10
Loaded from: ./output/stl10/gtsrb_backdoored_encoder/2024-01-05-17:11:20/model_200.pth
Namespace(batch_size=32, color=0.0, data_dir='./data/stl10/', encoder_usage_info='stl10', epochs=200, gpu='2', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=20.0, lr=0.001, pretrained_encoder='./output/stl10/clean_encoder/model_1000.pth', pretraining_dataset='stl10', psnr=0.025, rand_init=False, reference_file='./reference/stl10/priority.npz', reference_label=0, results_dir='./output/stl10/gtsrb_backdoored_encoder/2024-01-05-17:11:20/', saturation_hsv=1, seed=100, shadow_dataset='stl10', timestamp='2024-01-05-17:11:20', trigger_file='optimize_filter/trigger/stl10/2023-12-19-01-25-16/ssim0.9987_psnr42.79_lp0.0002_wd0.002_color4.971.pt', value_hsv=1)
{'loss': -20.967019327776686, 'wd': 0.0018520188688699805, 'ssim': 0.9964775321349292, 'psnr': 39.606104025309584, 'lp': 0.000549055989264888, 'sim': -20.967019327776686, 'far': 0.0, 'color': 5.009697832157609}
Predicting features
Feature extracting:   0%|          | 0/613 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/613 [00:05<52:17,  5.13s/it]Feature extracting:   3%|▎         | 16/613 [00:05<02:20,  4.25it/s]Feature extracting:   4%|▍         | 25/613 [00:05<01:20,  7.29it/s]Feature extracting:   5%|▌         | 33/613 [00:05<00:54, 10.69it/s]Feature extracting:   7%|▋         | 40/613 [00:05<00:39, 14.35it/s]Feature extracting:   8%|▊         | 48/613 [00:05<00:28, 19.72it/s]Feature extracting:   9%|▉         | 56/613 [00:05<00:21, 25.99it/s]Feature extracting:  10%|█         | 63/613 [00:05<00:17, 30.90it/s]Feature extracting:  11%|█▏        | 70/613 [00:06<00:15, 35.54it/s]Feature extracting:  13%|█▎        | 77/613 [00:06<00:13, 40.14it/s]Feature extracting:  14%|█▎        | 84/613 [00:06<00:12, 44.05it/s]Feature extracting:  15%|█▍        | 91/613 [00:06<00:11, 47.39it/s]Feature extracting:  16%|█▌        | 97/613 [00:06<00:10, 49.67it/s]Feature extracting:  17%|█▋        | 106/613 [00:06<00:09, 56.00it/s]Feature extracting:  19%|█▊        | 114/613 [00:06<00:08, 60.43it/s]Feature extracting:  20%|█▉        | 121/613 [00:06<00:08, 60.87it/s]Feature extracting:  21%|██        | 128/613 [00:07<00:08, 59.59it/s]Feature extracting:  22%|██▏       | 135/613 [00:07<00:08, 59.04it/s]Feature extracting:  23%|██▎       | 142/613 [00:07<00:08, 58.25it/s]Feature extracting:  24%|██▍       | 148/613 [00:07<00:07, 58.19it/s]Feature extracting:  25%|██▌       | 154/613 [00:07<00:07, 58.01it/s]Feature extracting:  26%|██▋       | 162/613 [00:07<00:07, 63.98it/s]Feature extracting:  28%|██▊       | 170/613 [00:07<00:06, 65.80it/s]Feature extracting:  29%|██▉       | 177/613 [00:07<00:06, 63.03it/s]Feature extracting:  30%|███       | 184/613 [00:07<00:07, 61.06it/s]Feature extracting:  31%|███       | 191/613 [00:08<00:07, 59.92it/s]Feature extracting:  32%|███▏      | 198/613 [00:08<00:07, 58.97it/s]Feature extracting:  33%|███▎      | 204/613 [00:08<00:06, 58.54it/s]Feature extracting:  34%|███▍      | 210/613 [00:08<00:06, 58.23it/s]Feature extracting:  36%|███▌      | 218/613 [00:08<00:06, 63.87it/s]Feature extracting:  37%|███▋      | 226/613 [00:08<00:05, 66.16it/s]Feature extracting:  38%|███▊      | 233/613 [00:08<00:05, 63.43it/s]Feature extracting:  39%|███▉      | 240/613 [00:08<00:06, 61.56it/s]Feature extracting:  40%|████      | 247/613 [00:08<00:06, 60.53it/s]Feature extracting:  41%|████▏     | 254/613 [00:09<00:06, 59.62it/s]Feature extracting:  42%|████▏     | 260/613 [00:09<00:05, 59.12it/s]Feature extracting:  43%|████▎     | 266/613 [00:09<00:06, 54.74it/s]Feature extracting:  45%|████▌     | 276/613 [00:09<00:05, 66.47it/s]Feature extracting:  46%|████▌     | 283/613 [00:09<00:05, 63.95it/s]Feature extracting:  47%|████▋     | 290/613 [00:09<00:05, 63.66it/s]Feature extracting:  48%|████▊     | 297/613 [00:09<00:05, 61.57it/s]Feature extracting:  50%|████▉     | 304/613 [00:09<00:05, 60.10it/s]Feature extracting:  51%|█████     | 311/613 [00:10<00:05, 59.17it/s]Feature extracting:  52%|█████▏    | 317/613 [00:10<00:05, 58.73it/s]Feature extracting:  53%|█████▎    | 323/613 [00:10<00:05, 57.35it/s]Feature extracting:  54%|█████▍    | 332/613 [00:10<00:04, 64.53it/s]Feature extracting:  55%|█████▌    | 339/613 [00:10<00:04, 62.14it/s]Feature extracting:  56%|█████▋    | 346/613 [00:10<00:04, 60.33it/s]Feature extracting:  58%|█████▊    | 353/613 [00:10<00:04, 59.12it/s]Feature extracting:  59%|█████▊    | 359/613 [00:10<00:04, 58.68it/s]Feature extracting:  60%|█████▉    | 366/613 [00:10<00:04, 59.99it/s]Feature extracting:  61%|██████    | 374/613 [00:11<00:03, 65.16it/s]Feature extracting:  63%|██████▎   | 388/613 [00:11<00:02, 84.70it/s]Feature extracting:  65%|██████▍   | 398/613 [00:11<00:02, 88.27it/s]Feature extracting:  66%|██████▋   | 407/613 [00:11<00:02, 85.84it/s]Feature extracting:  68%|██████▊   | 416/613 [00:11<00:02, 84.25it/s]Feature extracting:  69%|██████▉   | 425/613 [00:11<00:02, 82.86it/s]Feature extracting:  71%|███████   | 434/613 [00:11<00:02, 73.71it/s]Feature extracting:  73%|███████▎  | 445/613 [00:11<00:02, 80.92it/s]Feature extracting:  74%|███████▍  | 456/613 [00:11<00:01, 88.24it/s]Feature extracting:  76%|███████▌  | 466/613 [00:12<00:02, 67.62it/s]Feature extracting:  77%|███████▋  | 474/613 [00:12<00:02, 60.40it/s]Feature extracting:  78%|███████▊  | 481/613 [00:12<00:02, 56.44it/s]Feature extracting:  80%|███████▉  | 488/613 [00:12<00:02, 59.11it/s]Feature extracting:  81%|████████  | 498/613 [00:12<00:01, 68.72it/s]Feature extracting:  83%|████████▎ | 506/613 [00:12<00:01, 71.26it/s]Feature extracting:  84%|████████▍ | 514/613 [00:12<00:01, 67.78it/s]Feature extracting:  85%|████████▌ | 522/613 [00:13<00:01, 63.79it/s]Feature extracting:  86%|████████▋ | 529/613 [00:13<00:01, 63.27it/s]Feature extracting:  88%|████████▊ | 537/613 [00:13<00:01, 67.13it/s]Feature extracting:  89%|████████▉ | 545/613 [00:13<00:01, 56.14it/s]Feature extracting:  90%|█████████ | 554/613 [00:13<00:00, 63.85it/s]Feature extracting:  92%|█████████▏| 562/613 [00:13<00:00, 67.75it/s]Feature extracting:  93%|█████████▎| 570/613 [00:13<00:00, 56.50it/s]Feature extracting:  94%|█████████▍| 579/613 [00:14<00:00, 62.41it/s]Feature extracting:  96%|█████████▌| 586/613 [00:14<00:00, 53.43it/s]Feature extracting:  98%|█████████▊| 599/613 [00:14<00:00, 63.99it/s]Feature extracting:  99%|█████████▉| 606/613 [00:14<00:00, 50.66it/s]Feature extracting: 100%|██████████| 613/613 [00:14<00:00, 50.18it/s]Feature extracting: 100%|██████████| 613/613 [00:14<00:00, 41.23it/s]
Feature extracting:   0%|          | 0/198 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/198 [00:00<02:43,  1.20it/s]Feature extracting:   5%|▌         | 10/198 [00:00<00:13, 14.19it/s]Feature extracting:  14%|█▎        | 27/198 [00:01<00:04, 40.35it/s]Feature extracting:  19%|█▊        | 37/198 [00:01<00:03, 48.19it/s]Feature extracting:  23%|██▎       | 46/198 [00:01<00:02, 53.25it/s]Feature extracting:  29%|██▉       | 58/198 [00:01<00:02, 67.32it/s]Feature extracting:  34%|███▍      | 68/198 [00:01<00:02, 60.51it/s]Feature extracting:  38%|███▊      | 76/198 [00:01<00:02, 56.64it/s]Feature extracting:  42%|████▏     | 83/198 [00:01<00:02, 54.11it/s]Feature extracting:  45%|████▌     | 90/198 [00:02<00:02, 51.94it/s]Feature extracting:  48%|████▊     | 96/198 [00:02<00:02, 50.87it/s]Feature extracting:  52%|█████▏    | 102/198 [00:02<00:01, 49.68it/s]Feature extracting:  55%|█████▍    | 108/198 [00:02<00:01, 52.06it/s]Feature extracting:  58%|█████▊    | 114/198 [00:02<00:01, 52.67it/s]Feature extracting:  61%|██████    | 120/198 [00:02<00:01, 53.04it/s]Feature extracting:  64%|██████▎   | 126/198 [00:02<00:01, 51.15it/s]Feature extracting:  67%|██████▋   | 132/198 [00:02<00:01, 49.82it/s]Feature extracting:  70%|██████▉   | 138/198 [00:03<00:01, 49.89it/s]Feature extracting:  73%|███████▎  | 144/198 [00:03<00:01, 48.92it/s]Feature extracting:  75%|███████▌  | 149/198 [00:03<00:01, 48.45it/s]Feature extracting:  78%|███████▊  | 154/198 [00:03<00:00, 48.13it/s]Feature extracting:  80%|████████  | 159/198 [00:03<00:00, 48.40it/s]Feature extracting:  83%|████████▎ | 164/198 [00:03<00:00, 45.73it/s]Feature extracting:  87%|████████▋ | 173/198 [00:03<00:00, 57.07it/s]Feature extracting:  90%|█████████ | 179/198 [00:03<00:00, 54.22it/s]Feature extracting:  93%|█████████▎| 185/198 [00:03<00:00, 51.79it/s]Feature extracting:  96%|█████████▋| 191/198 [00:04<00:00, 50.55it/s]Feature extracting:  99%|█████████▉| 197/198 [00:04<00:00, 49.22it/s]Feature extracting: 100%|██████████| 198/198 [00:04<00:00, 41.75it/s]
Feature extracting:   0%|          | 0/198 [00:00<?, ?it/s]