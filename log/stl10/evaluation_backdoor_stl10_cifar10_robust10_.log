transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomApply([transforms.ColorJitter(0.4, 0.4, 0.4, 0.1)], p=0.8),
    transforms.RandomGrayscale(p=0.2)
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-06 20:01:30
当前时间： 2024-01-06 20:01:31
test_transform_stl10
Loaded from: ./output/stl10/cifar10_backdoored_encoder/2024-01-05-17:10:47/model_200.pth
Namespace(batch_size=32, color=0.0, data_dir='./data/stl10/', encoder_usage_info='stl10', epochs=200, gpu='1', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=20.0, lr=0.001, pretrained_encoder='./output/stl10/clean_encoder/model_1000.pth', pretraining_dataset='stl10', psnr=0.025, rand_init=False, reference_file='./reference/stl10/airplane.npz', reference_label=0, results_dir='./output/stl10/cifar10_backdoored_encoder/2024-01-05-17:10:47/', saturation_hsv=1, seed=100, shadow_dataset='stl10', timestamp='2024-01-05-17:10:47', trigger_file='optimize_filter/trigger/stl10/2023-12-19-01-25-16/ssim0.9987_psnr42.79_lp0.0002_wd0.002_color4.971.pt', value_hsv=1)
{'loss': -20.951350208433887, 'wd': 0.0018064033534527916, 'ssim': 0.9964274972791708, 'psnr': 39.506030809253495, 'lp': 0.0005328581722628902, 'sim': -20.951350208433887, 'far': 0.0, 'color': 5.0124844556886625}
Predicting features
Feature extracting:   0%|          | 0/782 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/782 [00:03<49:15,  3.78s/it]Feature extracting:   2%|▏         | 14/782 [00:03<02:34,  4.96it/s]Feature extracting:   3%|▎         | 21/782 [00:04<01:34,  8.02it/s]Feature extracting:   4%|▎         | 28/782 [00:04<01:03, 11.92it/s]Feature extracting:   4%|▍         | 35/782 [00:04<00:45, 16.48it/s]Feature extracting:   5%|▌         | 41/782 [00:04<00:36, 20.57it/s]Feature extracting:   7%|▋         | 57/782 [00:04<00:19, 37.87it/s]Feature extracting:   8%|▊         | 66/782 [00:04<00:16, 43.80it/s]Feature extracting:  10%|▉         | 76/782 [00:04<00:13, 52.88it/s]Feature extracting:  11%|█         | 85/782 [00:04<00:11, 59.87it/s]Feature extracting:  12%|█▏        | 97/782 [00:04<00:09, 72.72it/s]Feature extracting:  14%|█▍        | 109/782 [00:05<00:08, 83.26it/s]Feature extracting:  15%|█▌        | 120/782 [00:05<00:08, 77.48it/s]Feature extracting:  17%|█▋        | 131/782 [00:05<00:07, 82.57it/s]Feature extracting:  18%|█▊        | 143/782 [00:05<00:07, 90.53it/s]Feature extracting:  20%|█▉        | 153/782 [00:05<00:06, 90.09it/s]Feature extracting:  21%|██        | 163/782 [00:05<00:06, 92.19it/s]Feature extracting:  22%|██▏       | 173/782 [00:05<00:06, 90.39it/s]Feature extracting:  23%|██▎       | 183/782 [00:05<00:06, 92.60it/s]Feature extracting:  25%|██▍       | 193/782 [00:05<00:06, 87.86it/s]Feature extracting:  26%|██▌       | 204/782 [00:06<00:06, 86.46it/s]Feature extracting:  28%|██▊       | 216/782 [00:06<00:05, 94.91it/s]Feature extracting:  29%|██▉       | 226/782 [00:06<00:05, 94.33it/s]Feature extracting:  30%|███       | 236/782 [00:06<00:05, 95.20it/s]Feature extracting:  31%|███▏      | 246/782 [00:06<00:05, 89.42it/s]Feature extracting:  33%|███▎      | 259/782 [00:06<00:05, 97.12it/s]Feature extracting:  35%|███▍      | 270/782 [00:06<00:05, 98.60it/s]Feature extracting:  36%|███▌      | 280/782 [00:06<00:05, 96.94it/s]Feature extracting:  38%|███▊      | 295/782 [00:06<00:04, 111.28it/s]Feature extracting:  39%|███▉      | 307/782 [00:07<00:04, 101.97it/s]Feature extracting:  41%|████      | 318/782 [00:07<00:04, 101.54it/s]Feature extracting:  42%|████▏     | 329/782 [00:07<00:04, 94.18it/s] Feature extracting:  43%|████▎     | 339/782 [00:07<00:04, 90.90it/s]Feature extracting:  45%|████▍     | 351/782 [00:07<00:04, 91.36it/s]Feature extracting:  47%|████▋     | 365/782 [00:07<00:04, 103.61it/s]Feature extracting:  48%|████▊     | 376/782 [00:07<00:04, 96.07it/s] Feature extracting:  49%|████▉     | 386/782 [00:07<00:04, 90.04it/s]Feature extracting:  51%|█████     | 396/782 [00:08<00:04, 89.18it/s]Feature extracting:  52%|█████▏    | 406/782 [00:08<00:04, 89.64it/s]Feature extracting:  53%|█████▎    | 418/782 [00:08<00:03, 96.25it/s]Feature extracting:  55%|█████▍    | 429/782 [00:08<00:03, 99.48it/s]Feature extracting:  56%|█████▋    | 440/782 [00:08<00:03, 89.59it/s]Feature extracting:  58%|█████▊    | 450/782 [00:08<00:04, 82.41it/s]Feature extracting:  59%|█████▊    | 459/782 [00:08<00:04, 74.88it/s]Feature extracting:  60%|█████▉    | 467/782 [00:09<00:04, 69.73it/s]Feature extracting:  61%|██████    | 475/782 [00:09<00:04, 67.85it/s]Feature extracting:  62%|██████▏   | 484/782 [00:09<00:04, 72.68it/s]Feature extracting:  63%|██████▎   | 492/782 [00:09<00:04, 67.78it/s]Feature extracting:  64%|██████▍   | 499/782 [00:09<00:04, 61.21it/s]Feature extracting:  65%|██████▍   | 507/782 [00:09<00:04, 63.33it/s]Feature extracting:  66%|██████▌   | 514/782 [00:09<00:04, 61.50it/s]Feature extracting:  67%|██████▋   | 521/782 [00:09<00:04, 60.37it/s]Feature extracting:  68%|██████▊   | 528/782 [00:09<00:04, 62.28it/s]Feature extracting:  69%|██████▊   | 537/782 [00:10<00:03, 68.74it/s]Feature extracting:  70%|██████▉   | 544/782 [00:10<00:03, 65.15it/s]Feature extracting:  70%|███████   | 551/782 [00:10<00:03, 62.64it/s]Feature extracting:  71%|███████▏  | 558/782 [00:10<00:03, 60.97it/s]Feature extracting:  72%|███████▏  | 565/782 [00:10<00:03, 59.66it/s]Feature extracting:  73%|███████▎  | 572/782 [00:10<00:03, 59.20it/s]Feature extracting:  74%|███████▍  | 578/782 [00:10<00:03, 58.32it/s]Feature extracting:  75%|███████▍  | 585/782 [00:10<00:03, 60.87it/s]Feature extracting:  76%|███████▌  | 594/782 [00:11<00:02, 67.27it/s]Feature extracting:  77%|███████▋  | 601/782 [00:11<00:02, 64.13it/s]Feature extracting:  78%|███████▊  | 608/782 [00:11<00:02, 61.82it/s]Feature extracting:  79%|███████▊  | 615/782 [00:11<00:02, 60.38it/s]Feature extracting:  80%|███████▉  | 622/782 [00:11<00:02, 59.38it/s]Feature extracting:  80%|████████  | 628/782 [00:11<00:02, 58.63it/s]Feature extracting:  81%|████████  | 634/782 [00:11<00:02, 58.26it/s]Feature extracting:  82%|████████▏ | 641/782 [00:11<00:02, 56.87it/s]Feature extracting:  83%|████████▎ | 651/782 [00:11<00:01, 68.12it/s]Feature extracting:  84%|████████▍ | 658/782 [00:12<00:01, 64.81it/s]Feature extracting:  85%|████████▌ | 665/782 [00:12<00:01, 62.58it/s]Feature extracting:  86%|████████▌ | 672/782 [00:12<00:01, 61.15it/s]Feature extracting:  87%|████████▋ | 679/782 [00:12<00:01, 59.45it/s]Feature extracting:  88%|████████▊ | 686/782 [00:12<00:01, 59.62it/s]Feature extracting:  88%|████████▊ | 692/782 [00:12<00:01, 59.20it/s]Feature extracting:  89%|████████▉ | 698/782 [00:12<00:01, 57.35it/s]Feature extracting:  91%|█████████ | 708/782 [00:12<00:01, 66.97it/s]Feature extracting:  91%|█████████▏| 715/782 [00:13<00:01, 64.58it/s]Feature extracting:  92%|█████████▏| 722/782 [00:13<00:00, 62.17it/s]Feature extracting:  93%|█████████▎| 729/782 [00:13<00:00, 60.63it/s]Feature extracting:  94%|█████████▍| 736/782 [00:13<00:00, 59.44it/s]Feature extracting:  95%|█████████▍| 742/782 [00:13<00:00, 58.88it/s]Feature extracting:  96%|█████████▌| 748/782 [00:13<00:00, 53.17it/s]Feature extracting:  97%|█████████▋| 759/782 [00:13<00:00, 65.61it/s]Feature extracting:  98%|█████████▊| 766/782 [00:13<00:00, 62.77it/s]Feature extracting:  99%|█████████▉| 773/782 [00:13<00:00, 60.92it/s]Feature extracting: 100%|█████████▉| 780/782 [00:14<00:00, 59.88it/s]Feature extracting: 100%|██████████| 782/782 [00:14<00:00, 54.04it/s]
Feature extracting:   0%|          | 0/157 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/157 [00:01<03:03,  1.18s/it]Feature extracting:   7%|▋         | 11/157 [00:01<00:12, 11.55it/s]Feature extracting:  13%|█▎        | 20/157 [00:01<00:06, 20.88it/s]Feature extracting:  21%|██        | 33/157 [00:01<00:03, 37.51it/s]Feature extracting:  27%|██▋       | 42/157 [00:01<00:02, 43.48it/s]Feature extracting:  32%|███▏      | 50/157 [00:01<00:02, 46.75it/s]Feature extracting:  37%|███▋      | 58/157 [00:01<00:01, 49.53it/s]Feature extracting:  42%|████▏     | 66/157 [00:02<00:01, 55.18it/s]Feature extracting:  48%|████▊     | 75/157 [00:02<00:01, 60.22it/s]Feature extracting:  53%|█████▎    | 83/157 [00:02<00:01, 61.28it/s]Feature extracting:  57%|█████▋    | 90/157 [00:02<00:01, 59.58it/s]Feature extracting:  62%|██████▏   | 97/157 [00:02<00:01, 59.43it/s]Feature extracting:  66%|██████▌   | 104/157 [00:02<00:00, 58.77it/s]Feature extracting:  71%|███████   | 111/157 [00:02<00:00, 58.26it/s]Feature extracting:  75%|███████▍  | 117/157 [00:03<00:00, 45.79it/s]Feature extracting:  78%|███████▊  | 123/157 [00:03<00:01, 30.77it/s]Feature extracting:  82%|████████▏ | 129/157 [00:03<00:00, 32.72it/s]Feature extracting:  94%|█████████▎| 147/157 [00:03<00:00, 58.52it/s]Feature extracting: 100%|██████████| 157/157 [00:03<00:00, 66.89it/s]Feature extracting: 100%|██████████| 157/157 [00:03<00:00, 40.32it/s]
Feature extracting:   0%|          | 0/157 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/157 [00:01<02:51,  1.10s/it]Feature extracting:   3%|▎         | 4/157 [00:01<00:35,  4.26it/s]Feature extracting:   4%|▍         | 7/157 [00:01<00:19,  7.70it/s]Feature extracting:   6%|▋         | 10/157 [00:01<00:13, 11.28it/s]Feature extracting:   8%|▊         | 13/157 [00:01<00:09, 14.74it/s]Feature extracting:  10%|█         | 16/157 [00:01<00:07, 17.65it/s]Feature extracting:  12%|█▏        | 19/157 [00:01<00:06, 20.24it/s]Feature extracting:  14%|█▍        | 22/157 [00:01<00:06, 22.28it/s]Feature extracting:  16%|█▌        | 25/157 [00:01<00:05, 23.88it/s]Feature extracting:  18%|█▊        | 28/157 [00:02<00:05, 24.30it/s]Feature extracting:  20%|██        | 32/157 [00:02<00:04, 28.35it/s]Feature extracting:  23%|██▎       | 36/157 [00:02<00:04, 28.59it/s]Feature extracting:  25%|██▌       | 40/157 [00:02<00:04, 28.13it/s]Feature extracting:  27%|██▋       | 43/157 [00:02<00:03, 28.53it/s]Feature extracting:  29%|██▉       | 46/157 [00:02<00:04, 25.99it/s]Feature extracting:  31%|███       | 49/157 [00:02<00:04, 26.59it/s]Feature extracting:  33%|███▎      | 52/157 [00:02<00:03, 27.00it/s]Feature extracting:  35%|███▌      | 55/157 [00:03<00:03, 27.42it/s]Feature extracting:  37%|███▋      | 58/157 [00:03<00:03, 27.64it/s]Feature extracting:  39%|███▉      | 62/157 [00:03<00:03, 26.64it/s]Feature extracting:  41%|████▏     | 65/157 [00:03<00:03, 27.07it/s]Feature extracting:  43%|████▎     | 68/157 [00:03<00:03, 26.62it/s]Feature extracting:  45%|████▌     | 71/157 [00:03<00:03, 27.09it/s]Feature extracting:  47%|████▋     | 74/157 [00:03<00:03, 27.41it/s]Feature extracting:  49%|████▉     | 77/157 [00:03<00:02, 27.64it/s]Feature extracting:  51%|█████     | 80/157 [00:03<00:03, 24.86it/s]Feature extracting:  53%|█████▎    | 83/157 [00:04<00:02, 25.92it/s]Feature extracting:  55%|█████▌    | 87/157 [00:04<00:02, 29.06it/s]Feature extracting:  59%|█████▉    | 93/157 [00:04<00:01, 36.31it/s]Feature extracting:  62%|██████▏   | 97/157 [00:04<00:01, 37.06it/s]Feature extracting:  64%|██████▍   | 101/157 [00:04<00:01, 35.85it/s]Feature extracting:  67%|██████▋   | 105/157 [00:04<00:01, 35.62it/s]Feature extracting:  69%|██████▉   | 109/157 [00:04<00:01, 36.24it/s]Feature extracting:  72%|███████▏  | 113/157 [00:04<00:01, 36.37it/s]Feature extracting:  75%|███████▍  | 117/157 [00:04<00:01, 36.66it/s]Feature extracting:  78%|███████▊  | 122/157 [00:05<00:00, 38.89it/s]Feature extracting:  81%|████████  | 127/157 [00:05<00:00, 40.94it/s]Feature extracting:  84%|████████▍ | 132/157 [00:05<00:00, 39.48it/s]Feature extracting:  87%|████████▋ | 136/157 [00:05<00:00, 38.64it/s]Feature extracting:  89%|████████▉ | 140/157 [00:05<00:00, 38.00it/s]Feature extracting:  92%|█████████▏| 144/157 [00:05<00:00, 37.63it/s]Feature extracting:  94%|█████████▍| 148/157 [00:05<00:00, 37.62it/s]Feature extracting:  97%|█████████▋| 152/157 [00:05<00:00, 37.38it/s]