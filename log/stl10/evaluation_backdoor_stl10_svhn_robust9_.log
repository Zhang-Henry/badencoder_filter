transforms.GaussianBlur(kernel_size=7)
transforms.GaussianBlur(kernel_size=7)
transforms.GaussianBlur(kernel_size=7)
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-06 19:59:42
当前时间： 2024-01-06 19:59:43
test_transform_stl10
Loaded from: ./output/stl10/svhn_backdoored_encoder/2024-01-05-17:11:23/model_200.pth
Namespace(batch_size=32, color=0.0, data_dir='./data/stl10/', encoder_usage_info='stl10', epochs=200, gpu='4', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=20.0, lr=0.001, pretrained_encoder='./output/stl10/clean_encoder/model_1000.pth', pretraining_dataset='stl10', psnr=0.025, rand_init=False, reference_file='./reference/stl10/one.npz', reference_label=0, results_dir='./output/stl10/svhn_backdoored_encoder/2024-01-05-17:11:23/', saturation_hsv=1, seed=100, shadow_dataset='stl10', timestamp='2024-01-05-17:11:23', trigger_file='optimize_filter/trigger/stl10/2023-12-19-01-25-16/ssim0.9987_psnr42.79_lp0.0002_wd0.002_color4.971.pt', value_hsv=1)
{'loss': -20.961791233888203, 'wd': 0.0018395297552795294, 'ssim': 0.9961507282244869, 'psnr': 39.41752154512686, 'lp': 0.000544258705861754, 'sim': -20.961791233888203, 'far': 0.0, 'color': 5.099621719037983}
Predicting features
Feature extracting:   0%|          | 0/1145 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/1145 [00:04<1:30:39,  4.75s/it]Feature extracting:   1%|▏         | 17/1145 [00:04<03:52,  4.85it/s] Feature extracting:   2%|▏         | 26/1145 [00:05<02:18,  8.10it/s]Feature extracting:   3%|▎         | 34/1145 [00:05<01:34, 11.73it/s]Feature extracting:   4%|▎         | 42/1145 [00:05<01:07, 16.30it/s]Feature extracting:   4%|▍         | 49/1145 [00:05<00:52, 20.97it/s]Feature extracting:   5%|▍         | 56/1145 [00:05<00:41, 26.44it/s]Feature extracting:   6%|▌         | 64/1145 [00:05<00:32, 33.24it/s]Feature extracting:   6%|▋         | 72/1145 [00:05<00:26, 39.98it/s]Feature extracting:   7%|▋         | 80/1145 [00:05<00:22, 47.00it/s]Feature extracting:   8%|▊         | 88/1145 [00:05<00:20, 52.20it/s]Feature extracting:   8%|▊         | 96/1145 [00:06<00:18, 56.21it/s]Feature extracting:   9%|▉         | 104/1145 [00:06<00:17, 59.58it/s]Feature extracting:  10%|▉         | 112/1145 [00:06<00:16, 63.26it/s]Feature extracting:  11%|█         | 121/1145 [00:06<00:14, 68.86it/s]Feature extracting:  11%|█▏        | 129/1145 [00:06<00:14, 70.27it/s]Feature extracting:  12%|█▏        | 137/1145 [00:06<00:14, 70.49it/s]Feature extracting:  13%|█▎        | 145/1145 [00:06<00:14, 70.65it/s]Feature extracting:  13%|█▎        | 153/1145 [00:06<00:13, 71.10it/s]Feature extracting:  14%|█▍        | 161/1145 [00:06<00:13, 72.47it/s]Feature extracting:  15%|█▍        | 169/1145 [00:07<00:13, 71.13it/s]Feature extracting:  15%|█▌        | 177/1145 [00:07<00:13, 70.30it/s]Feature extracting:  16%|█▌        | 185/1145 [00:07<00:13, 70.65it/s]Feature extracting:  17%|█▋        | 193/1145 [00:07<00:13, 70.55it/s]Feature extracting:  18%|█▊        | 201/1145 [00:07<00:13, 71.63it/s]Feature extracting:  18%|█▊        | 209/1145 [00:07<00:13, 71.86it/s]Feature extracting:  19%|█▉        | 217/1145 [00:07<00:12, 71.76it/s]Feature extracting:  20%|█▉        | 225/1145 [00:07<00:12, 71.97it/s]Feature extracting:  20%|██        | 233/1145 [00:07<00:12, 72.26it/s]Feature extracting:  21%|██        | 241/1145 [00:08<00:12, 73.03it/s]Feature extracting:  22%|██▏       | 249/1145 [00:08<00:12, 73.37it/s]Feature extracting:  22%|██▏       | 257/1145 [00:08<00:12, 72.15it/s]Feature extracting:  23%|██▎       | 265/1145 [00:08<00:12, 69.82it/s]Feature extracting:  24%|██▍       | 273/1145 [00:08<00:12, 68.26it/s]Feature extracting:  24%|██▍       | 280/1145 [00:08<00:12, 67.37it/s]Feature extracting:  25%|██▌       | 287/1145 [00:08<00:13, 64.56it/s]Feature extracting:  26%|██▌       | 295/1145 [00:08<00:12, 68.09it/s]Feature extracting:  26%|██▋       | 302/1145 [00:08<00:12, 67.44it/s]Feature extracting:  27%|██▋       | 309/1145 [00:09<00:12, 66.52it/s]Feature extracting:  28%|██▊       | 316/1145 [00:09<00:13, 60.33it/s]Feature extracting:  28%|██▊       | 323/1145 [00:09<00:14, 56.99it/s]Feature extracting:  29%|██▊       | 329/1145 [00:09<00:15, 53.62it/s]Feature extracting:  29%|██▉       | 335/1145 [00:09<00:15, 50.77it/s]Feature extracting:  30%|██▉       | 341/1145 [00:09<00:16, 48.71it/s]Feature extracting:  30%|███       | 346/1145 [00:09<00:17, 46.89it/s]Feature extracting:  31%|███       | 351/1145 [00:09<00:17, 44.33it/s]Feature extracting:  31%|███▏      | 358/1145 [00:10<00:15, 50.14it/s]Feature extracting:  32%|███▏      | 364/1145 [00:10<00:15, 51.67it/s]Feature extracting:  32%|███▏      | 370/1145 [00:10<00:14, 51.81it/s]Feature extracting:  33%|███▎      | 379/1145 [00:10<00:12, 61.53it/s]Feature extracting:  34%|███▎      | 386/1145 [00:10<00:13, 57.65it/s]Feature extracting:  35%|███▍      | 396/1145 [00:10<00:10, 68.57it/s]Feature extracting:  35%|███▌      | 404/1145 [00:10<00:10, 70.91it/s]Feature extracting:  36%|███▌      | 412/1145 [00:10<00:10, 66.88it/s]Feature extracting:  37%|███▋      | 419/1145 [00:10<00:11, 65.68it/s]Feature extracting:  37%|███▋      | 426/1145 [00:11<00:11, 64.02it/s]Feature extracting:  38%|███▊      | 433/1145 [00:11<00:11, 61.07it/s]Feature extracting:  38%|███▊      | 440/1145 [00:11<00:11, 59.91it/s]Feature extracting:  39%|███▉      | 447/1145 [00:11<00:11, 59.03it/s]Feature extracting:  40%|███▉      | 454/1145 [00:11<00:11, 59.84it/s]Feature extracting:  40%|████      | 461/1145 [00:11<00:12, 53.77it/s]Feature extracting:  41%|████      | 467/1145 [00:11<00:13, 49.67it/s]Feature extracting:  41%|████▏     | 473/1145 [00:12<00:14, 46.68it/s]Feature extracting:  42%|████▏     | 478/1145 [00:12<00:14, 46.16it/s]Feature extracting:  42%|████▏     | 483/1145 [00:12<00:14, 44.63it/s]Feature extracting:  43%|████▎     | 488/1145 [00:12<00:15, 43.37it/s]Feature extracting:  43%|████▎     | 493/1145 [00:12<00:15, 42.50it/s]Feature extracting:  43%|████▎     | 498/1145 [00:12<00:15, 41.85it/s]Feature extracting:  44%|████▍     | 503/1145 [00:12<00:15, 41.72it/s]Feature extracting:  44%|████▍     | 508/1145 [00:12<00:15, 41.54it/s]Feature extracting:  45%|████▍     | 513/1145 [00:13<00:15, 41.17it/s]Feature extracting:  45%|████▌     | 518/1145 [00:13<00:15, 40.89it/s]Feature extracting:  46%|████▌     | 523/1145 [00:13<00:15, 41.38it/s]Feature extracting:  46%|████▌     | 528/1145 [00:13<00:14, 41.91it/s]Feature extracting:  47%|████▋     | 533/1145 [00:13<00:14, 41.60it/s]Feature extracting:  47%|████▋     | 538/1145 [00:13<00:14, 40.85it/s]Feature extracting:  47%|████▋     | 543/1145 [00:13<00:14, 40.33it/s]Feature extracting:  48%|████▊     | 548/1145 [00:13<00:14, 40.97it/s]Feature extracting:  48%|████▊     | 553/1145 [00:14<00:14, 40.66it/s]Feature extracting:  49%|████▊     | 558/1145 [00:14<00:14, 40.20it/s]Feature extracting:  49%|████▉     | 563/1145 [00:14<00:14, 40.40it/s]Feature extracting:  50%|████▉     | 568/1145 [00:14<00:14, 40.54it/s]Feature extracting:  50%|█████     | 573/1145 [00:14<00:13, 41.03it/s]Feature extracting:  50%|█████     | 578/1145 [00:14<00:13, 41.51it/s]Feature extracting:  51%|█████     | 583/1145 [00:14<00:13, 42.52it/s]Feature extracting:  51%|█████▏    | 588/1145 [00:14<00:12, 43.44it/s]Feature extracting:  52%|█████▏    | 593/1145 [00:14<00:12, 44.12it/s]Feature extracting:  52%|█████▏    | 598/1145 [00:15<00:12, 45.35it/s]Feature extracting:  53%|█████▎    | 603/1145 [00:15<00:11, 45.30it/s]Feature extracting:  53%|█████▎    | 608/1145 [00:15<00:11, 45.19it/s]Feature extracting:  54%|█████▎    | 613/1145 [00:15<00:11, 44.91it/s]Feature extracting:  54%|█████▍    | 618/1145 [00:15<00:11, 44.70it/s]Feature extracting:  54%|█████▍    | 623/1145 [00:15<00:11, 44.31it/s]Feature extracting:  55%|█████▍    | 628/1145 [00:15<00:11, 45.83it/s]Feature extracting:  55%|█████▌    | 633/1145 [00:15<00:11, 45.34it/s]Feature extracting:  56%|█████▌    | 638/1145 [00:15<00:11, 45.01it/s]Feature extracting:  56%|█████▌    | 643/1145 [00:16<00:11, 44.79it/s]Feature extracting:  57%|█████▋    | 648/1145 [00:16<00:11, 44.43it/s]Feature extracting:  57%|█████▋    | 654/1145 [00:16<00:10, 46.53it/s]Feature extracting:  58%|█████▊    | 660/1145 [00:16<00:10, 48.18it/s]Feature extracting:  58%|█████▊    | 666/1145 [00:16<00:09, 49.08it/s]Feature extracting:  59%|█████▊    | 671/1145 [00:16<00:09, 49.23it/s]Feature extracting:  59%|█████▉    | 676/1145 [00:16<00:09, 49.08it/s]Feature extracting:  60%|█████▉    | 682/1145 [00:16<00:09, 49.72it/s]Feature extracting:  60%|██████    | 688/1145 [00:16<00:08, 51.38it/s]Feature extracting:  61%|██████    | 694/1145 [00:17<00:08, 52.15it/s]Feature extracting:  61%|██████    | 700/1145 [00:17<00:08, 52.31it/s]Feature extracting:  62%|██████▏   | 706/1145 [00:17<00:08, 50.13it/s]Feature extracting:  62%|██████▏   | 712/1145 [00:17<00:08, 48.61it/s]Feature extracting:  63%|██████▎   | 717/1145 [00:17<00:09, 46.94it/s]Feature extracting:  63%|██████▎   | 722/1145 [00:17<00:09, 45.42it/s]Feature extracting:  63%|██████▎   | 727/1145 [00:17<00:09, 44.36it/s]Feature extracting:  64%|██████▍   | 732/1145 [00:17<00:09, 43.94it/s]Feature extracting:  64%|██████▍   | 737/1145 [00:18<00:09, 43.81it/s]Feature extracting:  65%|██████▍   | 742/1145 [00:18<00:09, 43.18it/s]Feature extracting:  65%|██████▌   | 747/1145 [00:18<00:09, 42.79it/s]Feature extracting:  66%|██████▌   | 752/1145 [00:18<00:09, 42.48it/s]Feature extracting:  66%|██████▌   | 757/1145 [00:18<00:09, 42.38it/s]Feature extracting:  67%|██████▋   | 762/1145 [00:18<00:08, 43.68it/s]Feature extracting:  67%|██████▋   | 767/1145 [00:18<00:08, 43.61it/s]Feature extracting:  67%|██████▋   | 772/1145 [00:18<00:08, 43.40it/s]Feature extracting:  68%|██████▊   | 777/1145 [00:18<00:08, 43.12it/s]Feature extracting:  68%|██████▊   | 782/1145 [00:19<00:08, 41.48it/s]Feature extracting:  69%|██████▉   | 788/1145 [00:19<00:08, 44.23it/s]Feature extracting:  69%|██████▉   | 793/1145 [00:19<00:07, 44.14it/s]Feature extracting:  70%|██████▉   | 798/1145 [00:19<00:07, 43.89it/s]Feature extracting:  70%|███████   | 803/1145 [00:19<00:07, 43.76it/s]Feature extracting:  71%|███████   | 808/1145 [00:19<00:07, 44.07it/s]Feature extracting:  71%|███████   | 813/1145 [00:19<00:07, 44.07it/s]Feature extracting:  71%|███████▏  | 818/1145 [00:19<00:07, 43.85it/s]Feature extracting:  72%|███████▏  | 823/1145 [00:19<00:07, 43.89it/s]Feature extracting:  72%|███████▏  | 828/1145 [00:20<00:07, 44.31it/s]Feature extracting:  73%|███████▎  | 833/1145 [00:20<00:07, 44.29it/s]Feature extracting:  73%|███████▎  | 838/1145 [00:20<00:06, 44.65it/s]Feature extracting:  74%|███████▎  | 843/1145 [00:20<00:06, 44.33it/s]Feature extracting:  74%|███████▍  | 848/1145 [00:20<00:06, 43.75it/s]Feature extracting:  74%|███████▍  | 853/1145 [00:20<00:06, 43.37it/s]Feature extracting:  75%|███████▍  | 858/1145 [00:20<00:06, 43.55it/s]Feature extracting:  75%|███████▌  | 863/1145 [00:20<00:06, 44.81it/s]Feature extracting:  76%|███████▌  | 869/1145 [00:21<00:05, 47.92it/s]Feature extracting:  76%|███████▋  | 875/1145 [00:21<00:05, 49.34it/s]Feature extracting:  77%|███████▋  | 881/1145 [00:21<00:05, 50.02it/s]Feature extracting:  77%|███████▋  | 887/1145 [00:21<00:05, 50.54it/s]Feature extracting:  78%|███████▊  | 893/1145 [00:21<00:04, 51.65it/s]Feature extracting:  79%|███████▊  | 899/1145 [00:21<00:04, 51.16it/s]Feature extracting:  79%|███████▉  | 905/1145 [00:21<00:04, 50.33it/s]Feature extracting:  80%|███████▉  | 911/1145 [00:21<00:04, 50.03it/s]Feature extracting:  80%|████████  | 917/1145 [00:21<00:04, 50.73it/s]Feature extracting:  81%|████████  | 923/1145 [00:22<00:04, 50.36it/s]Feature extracting:  81%|████████  | 930/1145 [00:22<00:04, 53.12it/s]Feature extracting:  82%|████████▏ | 937/1145 [00:22<00:03, 55.97it/s]Feature extracting:  82%|████████▏ | 944/1145 [00:22<00:03, 57.87it/s]Feature extracting:  83%|████████▎ | 951/1145 [00:22<00:03, 59.72it/s]Feature extracting:  84%|████████▎ | 958/1145 [00:22<00:03, 62.10it/s]Feature extracting:  84%|████████▍ | 965/1145 [00:22<00:02, 63.80it/s]Feature extracting:  85%|████████▍ | 972/1145 [00:22<00:02, 64.68it/s]Feature extracting:  86%|████████▌ | 979/1145 [00:22<00:02, 65.60it/s]Feature extracting:  86%|████████▌ | 986/1145 [00:23<00:02, 65.80it/s]Feature extracting:  87%|████████▋ | 993/1145 [00:23<00:02, 65.82it/s]Feature extracting:  87%|████████▋ | 1000/1145 [00:23<00:02, 61.77it/s]Feature extracting:  88%|████████▊ | 1007/1145 [00:23<00:02, 55.76it/s]Feature extracting:  88%|████████▊ | 1013/1145 [00:23<00:02, 52.71it/s]Feature extracting:  89%|████████▉ | 1019/1145 [00:23<00:02, 50.56it/s]Feature extracting:  90%|████████▉ | 1025/1145 [00:23<00:02, 49.58it/s]Feature extracting:  90%|█████████ | 1031/1145 [00:23<00:02, 46.21it/s]Feature extracting:  90%|█████████ | 1036/1145 [00:24<00:02, 43.71it/s]Feature extracting:  91%|█████████ | 1041/1145 [00:24<00:02, 41.83it/s]Feature extracting:  91%|█████████▏| 1046/1145 [00:24<00:02, 41.03it/s]Feature extracting:  92%|█████████▏| 1051/1145 [00:24<00:02, 39.87it/s]Feature extracting:  92%|█████████▏| 1056/1145 [00:24<00:02, 39.05it/s]Feature extracting:  93%|█████████▎| 1060/1145 [00:24<00:02, 38.53it/s]Feature extracting:  93%|█████████▎| 1064/1145 [00:24<00:02, 38.47it/s]Feature extracting:  93%|█████████▎| 1068/1145 [00:24<00:01, 38.61it/s]Feature extracting:  94%|█████████▎| 1072/1145 [00:25<00:01, 38.21it/s]Feature extracting:  94%|█████████▍| 1076/1145 [00:25<00:01, 37.66it/s]Feature extracting:  94%|█████████▍| 1080/1145 [00:25<00:01, 36.97it/s]Feature extracting:  95%|█████████▍| 1084/1145 [00:25<00:01, 36.84it/s]Feature extracting:  95%|█████████▌| 1088/1145 [00:25<00:01, 37.53it/s]Feature extracting:  95%|█████████▌| 1092/1145 [00:25<00:01, 37.48it/s]Feature extracting:  96%|█████████▌| 1096/1145 [00:25<00:01, 37.15it/s]Feature extracting:  96%|█████████▌| 1100/1145 [00:25<00:01, 36.92it/s]Feature extracting:  96%|█████████▋| 1104/1145 [00:25<00:01, 37.61it/s]Feature extracting:  97%|█████████▋| 1108/1145 [00:26<00:00, 37.81it/s]Feature extracting:  97%|█████████▋| 1113/1145 [00:26<00:00, 38.30it/s]Feature extracting:  98%|█████████▊| 1117/1145 [00:26<00:00, 38.10it/s]Feature extracting:  98%|█████████▊| 1121/1145 [00:26<00:00, 37.84it/s]Feature extracting:  98%|█████████▊| 1125/1145 [00:26<00:00, 38.09it/s]Feature extracting:  99%|█████████▊| 1129/1145 [00:26<00:00, 38.19it/s]Feature extracting:  99%|█████████▉| 1134/1145 [00:26<00:00, 39.17it/s]Feature extracting:  99%|█████████▉| 1138/1145 [00:26<00:00, 38.99it/s]Feature extracting: 100%|█████████▉| 1143/1145 [00:26<00:00, 39.26it/s]Feature extracting: 100%|██████████| 1145/1145 [00:27<00:00, 41.96it/s]
Feature extracting:   0%|          | 0/407 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/407 [00:01<06:47,  1.00s/it]Feature extracting:   4%|▎         | 15/407 [00:01<00:21, 18.21it/s]Feature extracting:   6%|▌         | 23/407 [00:01<00:15, 25.53it/s]Feature extracting:   7%|▋         | 30/407 [00:01<00:12, 31.09it/s]Feature extracting:   9%|▉         | 37/407 [00:01<00:10, 36.71it/s]Feature extracting:  11%|█         | 43/407 [00:01<00:08, 40.64it/s]Feature extracting:  12%|█▏        | 49/407 [00:01<00:08, 44.14it/s]Feature extracting:  14%|█▎        | 55/407 [00:01<00:07, 46.99it/s]Feature extracting:  15%|█▍        | 61/407 [00:01<00:06, 49.49it/s]Feature extracting:  16%|█▋        | 67/407 [00:02<00:06, 51.26it/s]Feature extracting:  18%|█▊        | 73/407 [00:02<00:06, 53.33it/s]Feature extracting:  19%|█▉        | 79/407 [00:02<00:06, 53.18it/s]Feature extracting:  21%|██        | 85/407 [00:02<00:06, 52.76it/s]Feature extracting:  22%|██▏       | 91/407 [00:02<00:05, 53.31it/s]Feature extracting:  24%|██▍       | 97/407 [00:02<00:05, 54.43it/s]Feature extracting:  25%|██▌       | 103/407 [00:02<00:05, 55.65it/s]Feature extracting:  27%|██▋       | 109/407 [00:02<00:05, 55.86it/s]Feature extracting:  28%|██▊       | 115/407 [00:02<00:05, 55.97it/s]Feature extracting:  30%|██▉       | 121/407 [00:03<00:05, 55.64it/s]Feature extracting:  31%|███       | 127/407 [00:03<00:05, 55.97it/s]Feature extracting:  33%|███▎      | 133/407 [00:03<00:04, 56.67it/s]Feature extracting:  34%|███▍      | 139/407 [00:03<00:04, 57.11it/s]Feature extracting:  36%|███▌      | 145/407 [00:03<00:04, 54.73it/s]Feature extracting:  37%|███▋      | 151/407 [00:03<00:04, 51.97it/s]Feature extracting:  39%|███▊      | 157/407 [00:03<00:05, 49.86it/s]Feature extracting:  40%|████      | 163/407 [00:03<00:04, 49.20it/s]Feature extracting:  41%|████▏     | 168/407 [00:03<00:04, 48.29it/s]Feature extracting:  43%|████▎     | 173/407 [00:04<00:04, 47.83it/s]Feature extracting:  44%|████▎     | 178/407 [00:04<00:04, 47.53it/s]Feature extracting:  45%|████▍     | 183/407 [00:04<00:04, 47.40it/s]Feature extracting:  46%|████▌     | 188/407 [00:04<00:04, 47.62it/s]Feature extracting:  47%|████▋     | 193/407 [00:04<00:04, 47.85it/s]Feature extracting:  49%|████▊     | 198/407 [00:04<00:04, 47.80it/s]Feature extracting:  50%|████▉     | 203/407 [00:04<00:04, 47.46it/s]Feature extracting:  51%|█████     | 208/407 [00:04<00:04, 47.00it/s]Feature extracting:  52%|█████▏    | 213/407 [00:04<00:04, 46.12it/s]Feature extracting:  54%|█████▎    | 218/407 [00:05<00:04, 45.95it/s]Feature extracting:  55%|█████▍    | 223/407 [00:05<00:04, 45.15it/s]Feature extracting:  56%|█████▌    | 228/407 [00:05<00:04, 44.16it/s]Feature extracting:  57%|█████▋    | 233/407 [00:05<00:04, 43.34it/s]Feature extracting:  58%|█████▊    | 238/407 [00:05<00:03, 42.69it/s]Feature extracting:  60%|█████▉    | 243/407 [00:05<00:03, 43.07it/s]Feature extracting:  61%|██████    | 248/407 [00:05<00:03, 42.56it/s]Feature extracting:  62%|██████▏   | 253/407 [00:05<00:03, 42.36it/s]Feature extracting:  63%|██████▎   | 258/407 [00:05<00:03, 42.27it/s]Feature extracting:  65%|██████▍   | 263/407 [00:06<00:03, 43.38it/s]Feature extracting:  66%|██████▋   | 270/407 [00:06<00:02, 48.01it/s]Feature extracting:  68%|██████▊   | 276/407 [00:06<00:02, 49.73it/s]Feature extracting:  69%|██████▉   | 282/407 [00:06<00:02, 50.51it/s]Feature extracting:  71%|███████   | 288/407 [00:06<00:02, 50.49it/s]Feature extracting:  72%|███████▏  | 294/407 [00:06<00:02, 46.84it/s]Feature extracting:  74%|███████▍  | 302/407 [00:06<00:01, 53.83it/s]Feature extracting:  76%|███████▌  | 308/407 [00:06<00:01, 52.94it/s]Feature extracting:  77%|███████▋  | 314/407 [00:07<00:01, 53.24it/s]Feature extracting:  79%|███████▊  | 320/407 [00:07<00:01, 48.86it/s]Feature extracting:  80%|███████▉  | 325/407 [00:07<00:01, 47.52it/s]Feature extracting:  81%|████████  | 330/407 [00:07<00:01, 45.92it/s]Feature extracting:  82%|████████▏ | 335/407 [00:07<00:01, 44.22it/s]Feature extracting:  84%|████████▎ | 340/407 [00:07<00:01, 42.94it/s]Feature extracting:  85%|████████▍ | 345/407 [00:07<00:01, 41.60it/s]Feature extracting:  86%|████████▌ | 350/407 [00:07<00:01, 41.45it/s]Feature extracting:  87%|████████▋ | 355/407 [00:08<00:01, 40.34it/s]Feature extracting:  88%|████████▊ | 360/407 [00:08<00:01, 39.86it/s]Feature extracting:  89%|████████▉ | 364/407 [00:08<00:01, 39.81it/s]Feature extracting:  90%|█████████ | 368/407 [00:08<00:00, 39.26it/s]Feature extracting:  91%|█████████▏| 372/407 [00:08<00:00, 39.17it/s]Feature extracting:  92%|█████████▏| 376/407 [00:08<00:00, 38.69it/s]Feature extracting:  93%|█████████▎| 380/407 [00:08<00:00, 37.89it/s]Feature extracting:  94%|█████████▍| 384/407 [00:08<00:00, 37.92it/s]Feature extracting:  95%|█████████▌| 388/407 [00:08<00:00, 37.47it/s]Feature extracting:  96%|█████████▋| 392/407 [00:09<00:00, 37.26it/s]Feature extracting:  98%|█████████▊| 397/407 [00:09<00:00, 38.15it/s]Feature extracting:  99%|█████████▊| 401/407 [00:09<00:00, 38.00it/s]Feature extracting: 100%|█████████▉| 405/407 [00:09<00:00, 37.47it/s]Feature extracting: 100%|██████████| 407/407 [00:09<00:00, 41.61it/s]
Feature extracting:   0%|          | 0/407 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/407 [00:01<07:18,  1.08s/it]Feature extracting:   2%|▏         | 8/407 [00:01<00:45,  8.83it/s]Feature extracting:   3%|▎         | 14/407 [00:01<00:24, 15.98it/s]Feature extracting:   5%|▌         | 21/407 [00:01<00:15, 24.52it/s]Feature extracting:   7%|▋         | 27/407 [00:01<00:12, 30.94it/s]Feature extracting:   8%|▊         | 33/407 [00:01<00:10, 35.14it/s]Feature extracting:  10%|▉         | 39/407 [00:01<00:09, 40.25it/s]Feature extracting:  11%|█         | 45/407 [00:01<00:08, 44.50it/s]Feature extracting:  13%|█▎        | 52/407 [00:01<00:07, 50.64it/s]Feature extracting:  14%|█▍        | 59/407 [00:02<00:06, 54.60it/s]Feature extracting:  16%|█▌        | 66/407 [00:02<00:06, 54.71it/s]Feature extracting:  18%|█▊        | 72/407 [00:02<00:06, 55.03it/s]Feature extracting:  19%|█▉        | 78/407 [00:02<00:06, 53.75it/s]Feature extracting:  21%|██        | 84/407 [00:02<00:06, 53.64it/s]Feature extracting:  22%|██▏       | 90/407 [00:02<00:05, 53.92it/s]Feature extracting:  24%|██▎       | 96/407 [00:02<00:06, 51.61it/s]Feature extracting:  25%|██▌       | 102/407 [00:02<00:05, 50.87it/s]Feature extracting:  27%|██▋       | 108/407 [00:03<00:05, 50.15it/s]Feature extracting:  28%|██▊       | 114/407 [00:03<00:06, 46.43it/s]Feature extracting:  29%|██▉       | 119/407 [00:03<00:06, 45.47it/s]Feature extracting:  30%|███       | 124/407 [00:03<00:06, 44.60it/s]Feature extracting:  32%|███▏      | 129/407 [00:03<00:06, 43.83it/s]Feature extracting:  33%|███▎      | 134/407 [00:03<00:06, 43.16it/s]Feature extracting:  34%|███▍      | 140/407 [00:03<00:05, 46.79it/s]Feature extracting:  36%|███▌      | 145/407 [00:03<00:05, 45.85it/s]Feature extracting:  37%|███▋      | 150/407 [00:03<00:05, 45.14it/s]Feature extracting:  38%|███▊      | 155/407 [00:04<00:05, 43.42it/s]Feature extracting:  39%|███▉      | 160/407 [00:04<00:05, 42.16it/s]Feature extracting:  41%|████      | 166/407 [00:04<00:05, 45.85it/s]Feature extracting:  42%|████▏     | 172/407 [00:04<00:04, 49.06it/s]Feature extracting:  44%|████▍     | 179/407 [00:04<00:04, 53.45it/s]Feature extracting:  46%|████▌     | 186/407 [00:04<00:03, 55.91it/s]Feature extracting:  47%|████▋     | 193/407 [00:04<00:03, 58.73it/s]Feature extracting:  49%|████▉     | 200/407 [00:04<00:03, 60.89it/s]Feature extracting:  51%|█████     | 208/407 [00:04<00:03, 64.67it/s]Feature extracting:  53%|█████▎    | 215/407 [00:05<00:03, 61.99it/s]Feature extracting:  55%|█████▍    | 222/407 [00:05<00:03, 58.78it/s]Feature extracting:  56%|█████▌    | 228/407 [00:05<00:03, 58.50it/s]Feature extracting:  57%|█████▋    | 234/407 [00:05<00:02, 58.64it/s]Feature extracting:  59%|█████▉    | 242/407 [00:05<00:02, 62.27it/s]Feature extracting:  61%|██████    | 249/407 [00:05<00:02, 61.76it/s]Feature extracting:  63%|██████▎   | 256/407 [00:05<00:02, 61.37it/s]Feature extracting:  65%|██████▍   | 263/407 [00:05<00:02, 58.01it/s]Feature extracting:  66%|██████▌   | 269/407 [00:06<00:02, 56.76it/s]Feature extracting:  68%|██████▊   | 276/407 [00:06<00:02, 59.86it/s]Feature extracting:  70%|██████▉   | 283/407 [00:06<00:02, 54.43it/s]Feature extracting:  71%|███████   | 289/407 [00:06<00:02, 51.32it/s]Feature extracting:  72%|███████▏  | 295/407 [00:06<00:02, 49.86it/s]Feature extracting:  74%|███████▍  | 301/407 [00:06<00:02, 52.05it/s]Feature extracting:  75%|███████▌  | 307/407 [00:06<00:02, 49.75it/s]Feature extracting:  77%|███████▋  | 313/407 [00:06<00:01, 48.58it/s]Feature extracting:  78%|███████▊  | 318/407 [00:07<00:01, 47.80it/s]Feature extracting:  79%|███████▉  | 323/407 [00:07<00:01, 46.76it/s]Feature extracting:  81%|████████  | 330/407 [00:07<00:01, 49.82it/s]Feature extracting:  82%|████████▏ | 335/407 [00:07<00:01, 48.31it/s]Feature extracting:  84%|████████▎ | 340/407 [00:07<00:01, 47.12it/s]Feature extracting:  85%|████████▍ | 345/407 [00:07<00:01, 47.51it/s]Feature extracting:  86%|████████▌ | 350/407 [00:07<00:01, 47.39it/s]Feature extracting:  88%|████████▊ | 357/407 [00:07<00:00, 51.19it/s]Feature extracting:  89%|████████▉ | 363/407 [00:07<00:00, 49.59it/s]Feature extracting:  91%|█████████ | 369/407 [00:08<00:00, 51.68it/s]Feature extracting:  92%|█████████▏| 375/407 [00:08<00:00, 52.90it/s]Feature extracting:  94%|█████████▎| 381/407 [00:08<00:00, 53.21it/s]Feature extracting:  95%|█████████▌| 388/407 [00:08<00:00, 55.85it/s]Feature extracting:  97%|█████████▋| 394/407 [00:08<00:00, 54.06it/s]Feature extracting:  98%|█████████▊| 400/407 [00:08<00:00, 52.42it/s]Feature extracting: 100%|█████████▉| 406/407 [00:08<00:00, 52.77it/s]Feature extracting: 100%|██████████| 407/407 [00:09<00:00, 45.04it/s]
Feature extracting:   0%|          | 0/1 [00:00<?, ?it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  1.17it/s]Feature extracting: 100%|██████████| 1/1 [00:01<00:00,  1.00s/it]
feature banks saved to ./output/stl10/svhn_backdoored_encoder/2024-01-05-17:11:23/feature_banks.pkl
Train Epoch: 1 	Loss: 2.051851
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 33.4780270436386, "epoch": 1}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 1}
Train Epoch: 2 	Loss: 1.876385
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 36.97372464658881, "epoch": 2}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 2}
Train Epoch: 3 	Loss: 1.784217
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 41.54502151198525, "epoch": 3}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 3}
Train Epoch: 4 	Loss: 1.690658
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 45.92424708051629, "epoch": 4}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 4}
Train Epoch: 5 	Loss: 1.598532
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 49.40842040565458, "epoch": 5}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 5}
Train Epoch: 6 	Loss: 1.522419
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 51.87077443146896, "epoch": 6}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 6}
Train Epoch: 7 	Loss: 1.459426
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 53.910571604179474, "epoch": 7}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 7}
Train Epoch: 8 	Loss: 1.408406
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 55.57390903503381, "epoch": 8}
