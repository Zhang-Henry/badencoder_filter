transforms.GaussianBlur(kernel_size=7)
transforms.GaussianBlur(kernel_size=7)
transforms.GaussianBlur(kernel_size=7)
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-06 19:59:33
当前时间： 2024-01-06 19:59:35
test_transform_stl10
Loaded from: ./output/stl10/svhn_backdoored_encoder/2024-01-05-17:09:46/model_200.pth
Namespace(batch_size=64, color=0.3, data_dir='./data/stl10/', encoder_usage_info='stl10', epochs=200, gpu='5', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=20.0, lr=0.001, pretrained_encoder='./output/stl10/clean_encoder/model_1000.pth', pretraining_dataset='stl10', psnr=0.025, rand_init=False, reference_file='./reference/stl10/one.npz', reference_label=0, results_dir='./output/stl10/svhn_backdoored_encoder/2024-01-05-17:09:46/', saturation_hsv=1, seed=100, shadow_dataset='stl10', timestamp='2024-01-05-17:09:46', trigger_file='optimize_filter/trigger/stl10/2023-12-07-00-21-52/ssim0.9182_psnr22.37_lp0.0263_wd0.702_color10.051.pt', value_hsv=1)
{'loss': -23.067352141064045, 'wd': 0.04121247959226637, 'ssim': 0.9386369986662334, 'psnr': 23.39364955672534, 'lp': 0.021886712061801733, 'sim': -20.241976275181496, 'far': 2.8253759112156613, 'color': 9.417919337520527}
Predicting features
Feature extracting:   0%|          | 0/1145 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/1145 [00:03<1:10:50,  3.72s/it]Feature extracting:   1%|▏         | 17/1145 [00:03<03:02,  6.17it/s] Feature extracting:   2%|▏         | 26/1145 [00:03<01:49, 10.23it/s]Feature extracting:   3%|▎         | 35/1145 [00:04<01:14, 14.97it/s]Feature extracting:   4%|▍         | 43/1145 [00:04<00:55, 20.01it/s]Feature extracting:   4%|▍         | 50/1145 [00:04<00:43, 25.08it/s]Feature extracting:   5%|▌         | 58/1145 [00:04<00:33, 32.07it/s]Feature extracting:   6%|▌         | 66/1145 [00:04<00:27, 38.59it/s]Feature extracting:   6%|▋         | 74/1145 [00:04<00:23, 44.84it/s]Feature extracting:   7%|▋         | 82/1145 [00:04<00:21, 49.97it/s]Feature extracting:   8%|▊         | 89/1145 [00:04<00:19, 53.91it/s]Feature extracting:   8%|▊         | 97/1145 [00:05<00:18, 58.01it/s]Feature extracting:   9%|▉         | 107/1145 [00:05<00:15, 67.68it/s]Feature extracting:  10%|█         | 115/1145 [00:05<00:15, 67.05it/s]Feature extracting:  11%|█         | 123/1145 [00:05<00:15, 66.85it/s]Feature extracting:  11%|█▏        | 131/1145 [00:05<00:14, 68.34it/s]Feature extracting:  12%|█▏        | 140/1145 [00:05<00:13, 73.73it/s]Feature extracting:  13%|█▎        | 148/1145 [00:05<00:13, 74.62it/s]Feature extracting:  14%|█▎        | 156/1145 [00:05<00:13, 74.99it/s]Feature extracting:  14%|█▍        | 164/1145 [00:05<00:13, 75.34it/s]Feature extracting:  15%|█▌        | 173/1145 [00:05<00:12, 77.27it/s]Feature extracting:  16%|█▌        | 185/1145 [00:06<00:10, 87.66it/s]Feature extracting:  17%|█▋        | 195/1145 [00:06<00:10, 88.84it/s]Feature extracting:  18%|█▊        | 204/1145 [00:06<00:10, 87.44it/s]Feature extracting:  19%|█▊        | 213/1145 [00:06<00:11, 83.65it/s]Feature extracting:  19%|█▉        | 222/1145 [00:06<00:11, 81.93it/s]Feature extracting:  20%|██        | 231/1145 [00:06<00:11, 80.26it/s]Feature extracting:  21%|██        | 240/1145 [00:06<00:10, 82.57it/s]Feature extracting:  22%|██▏       | 249/1145 [00:06<00:10, 81.95it/s]Feature extracting:  23%|██▎       | 258/1145 [00:06<00:10, 81.08it/s]Feature extracting:  23%|██▎       | 267/1145 [00:07<00:10, 80.01it/s]Feature extracting:  24%|██▍       | 276/1145 [00:07<00:11, 78.68it/s]Feature extracting:  25%|██▍       | 285/1145 [00:07<00:10, 80.33it/s]Feature extracting:  26%|██▌       | 294/1145 [00:07<00:10, 81.30it/s]Feature extracting:  26%|██▋       | 303/1145 [00:07<00:10, 79.52it/s]Feature extracting:  27%|██▋       | 311/1145 [00:07<00:10, 78.50it/s]Feature extracting:  28%|██▊       | 319/1145 [00:07<00:10, 77.82it/s]Feature extracting:  29%|██▊       | 327/1145 [00:07<00:10, 76.63it/s]Feature extracting:  29%|██▉       | 336/1145 [00:07<00:10, 78.13it/s]Feature extracting:  30%|███       | 344/1145 [00:08<00:10, 76.28it/s]Feature extracting:  31%|███       | 352/1145 [00:08<00:10, 77.21it/s]Feature extracting:  32%|███▏      | 363/1145 [00:08<00:09, 85.42it/s]Feature extracting:  33%|███▎      | 375/1145 [00:08<00:08, 93.53it/s]Feature extracting:  34%|███▍      | 389/1145 [00:08<00:07, 105.46it/s]Feature extracting:  35%|███▍      | 400/1145 [00:08<00:06, 106.75it/s]Feature extracting:  36%|███▌      | 411/1145 [00:08<00:07, 101.55it/s]Feature extracting:  37%|███▋      | 422/1145 [00:08<00:07, 102.55it/s]Feature extracting:  38%|███▊      | 433/1145 [00:08<00:07, 95.54it/s] Feature extracting:  39%|███▊      | 443/1145 [00:09<00:08, 85.08it/s]Feature extracting:  39%|███▉      | 452/1145 [00:09<00:08, 84.65it/s]Feature extracting:  40%|████      | 461/1145 [00:09<00:11, 61.95it/s]Feature extracting:  41%|████      | 469/1145 [00:09<00:10, 62.55it/s]Feature extracting:  42%|████▏     | 476/1145 [00:09<00:10, 62.12it/s]Feature extracting:  43%|████▎     | 489/1145 [00:09<00:09, 66.70it/s]Feature extracting:  43%|████▎     | 497/1145 [00:10<00:09, 66.38it/s]Feature extracting:  44%|████▍     | 508/1145 [00:10<00:08, 76.23it/s]Feature extracting:  45%|████▌     | 518/1145 [00:10<00:07, 81.49it/s]Feature extracting:  46%|████▌     | 528/1145 [00:10<00:07, 86.13it/s]Feature extracting:  47%|████▋     | 537/1145 [00:10<00:07, 79.12it/s]Feature extracting:  48%|████▊     | 548/1145 [00:10<00:06, 86.97it/s]Feature extracting:  49%|████▊     | 558/1145 [00:10<00:06, 89.17it/s]Feature extracting:  50%|████▉     | 568/1145 [00:10<00:06, 89.21it/s]Feature extracting:  50%|█████     | 578/1145 [00:10<00:06, 82.05it/s]Feature extracting:  52%|█████▏    | 591/1145 [00:11<00:05, 93.19it/s]Feature extracting:  52%|█████▏    | 601/1145 [00:11<00:06, 85.89it/s]Feature extracting:  53%|█████▎    | 612/1145 [00:11<00:05, 90.39it/s]Feature extracting:  55%|█████▍    | 625/1145 [00:11<00:05, 90.04it/s]Feature extracting:  56%|█████▌    | 636/1145 [00:11<00:05, 94.86it/s]Feature extracting:  57%|█████▋    | 647/1145 [00:11<00:05, 97.89it/s]Feature extracting:  57%|█████▋    | 657/1145 [00:11<00:05, 92.61it/s]Feature extracting:  58%|█████▊    | 667/1145 [00:11<00:05, 88.86it/s]Feature extracting:  59%|█████▉    | 677/1145 [00:11<00:05, 88.35it/s]Feature extracting:  60%|██████    | 688/1145 [00:12<00:04, 92.20it/s]Feature extracting:  61%|██████    | 698/1145 [00:12<00:04, 90.82it/s]Feature extracting:  62%|██████▏   | 709/1145 [00:12<00:04, 93.81it/s]Feature extracting:  63%|██████▎   | 719/1145 [00:12<00:05, 78.89it/s]Feature extracting:  64%|██████▎   | 728/1145 [00:12<00:05, 69.71it/s]Feature extracting:  65%|██████▍   | 742/1145 [00:12<00:05, 72.53it/s]Feature extracting:  66%|██████▌   | 751/1145 [00:13<00:06, 63.09it/s]Feature extracting:  67%|██████▋   | 767/1145 [00:13<00:04, 77.13it/s]Feature extracting:  68%|██████▊   | 779/1145 [00:13<00:04, 85.52it/s]Feature extracting:  69%|██████▉   | 789/1145 [00:13<00:04, 88.78it/s]Feature extracting:  70%|██████▉   | 799/1145 [00:13<00:03, 87.45it/s]Feature extracting:  71%|███████   | 809/1145 [00:13<00:03, 88.20it/s]Feature extracting:  72%|███████▏  | 819/1145 [00:13<00:04, 76.44it/s]Feature extracting:  72%|███████▏  | 828/1145 [00:13<00:04, 75.68it/s]Feature extracting:  73%|███████▎  | 836/1145 [00:14<00:04, 73.86it/s]Feature extracting:  74%|███████▎  | 844/1145 [00:14<00:04, 72.30it/s]Feature extracting:  74%|███████▍  | 852/1145 [00:14<00:04, 72.18it/s]Feature extracting:  75%|███████▌  | 860/1145 [00:14<00:03, 72.02it/s]Feature extracting:  76%|███████▌  | 868/1145 [00:14<00:03, 72.77it/s]Feature extracting:  77%|███████▋  | 876/1145 [00:14<00:03, 71.54it/s]Feature extracting:  77%|███████▋  | 884/1145 [00:14<00:03, 70.71it/s]Feature extracting:  78%|███████▊  | 892/1145 [00:14<00:03, 70.23it/s]Feature extracting:  79%|███████▊  | 900/1145 [00:14<00:03, 71.82it/s]Feature extracting:  79%|███████▉  | 909/1145 [00:15<00:03, 75.20it/s]Feature extracting:  80%|████████  | 917/1145 [00:15<00:03, 74.72it/s]Feature extracting:  81%|████████  | 925/1145 [00:15<00:03, 73.31it/s]Feature extracting:  81%|████████▏ | 933/1145 [00:15<00:02, 72.64it/s]Feature extracting:  82%|████████▏ | 941/1145 [00:15<00:02, 72.56it/s]Feature extracting:  83%|████████▎ | 949/1145 [00:15<00:02, 73.26it/s]Feature extracting:  84%|████████▎ | 957/1145 [00:15<00:02, 71.68it/s]Feature extracting:  84%|████████▍ | 965/1145 [00:15<00:02, 71.12it/s]Feature extracting:  85%|████████▍ | 973/1145 [00:15<00:02, 71.14it/s]Feature extracting:  86%|████████▌ | 981/1145 [00:16<00:02, 70.13it/s]Feature extracting:  86%|████████▋ | 989/1145 [00:16<00:02, 71.54it/s]Feature extracting:  87%|████████▋ | 997/1145 [00:16<00:02, 72.21it/s]Feature extracting:  88%|████████▊ | 1005/1145 [00:16<00:01, 72.60it/s]Feature extracting:  88%|████████▊ | 1013/1145 [00:16<00:01, 72.05it/s]Feature extracting:  89%|████████▉ | 1021/1145 [00:16<00:01, 72.39it/s]Feature extracting:  90%|████████▉ | 1029/1145 [00:16<00:01, 70.55it/s]Feature extracting:  91%|█████████ | 1038/1145 [00:16<00:01, 73.23it/s]Feature extracting:  91%|█████████▏| 1046/1145 [00:16<00:01, 72.04it/s]Feature extracting:  92%|█████████▏| 1054/1145 [00:17<00:01, 69.71it/s]Feature extracting:  93%|█████████▎| 1061/1145 [00:17<00:01, 68.40it/s]Feature extracting:  93%|█████████▎| 1068/1145 [00:17<00:01, 67.49it/s]Feature extracting:  94%|█████████▍| 1076/1145 [00:17<00:01, 68.19it/s]Feature extracting:  95%|█████████▍| 1083/1145 [00:17<00:00, 67.01it/s]Feature extracting:  95%|█████████▌| 1090/1145 [00:17<00:00, 66.53it/s]Feature extracting:  96%|█████████▌| 1097/1145 [00:17<00:00, 64.65it/s]Feature extracting:  96%|█████████▋| 1104/1145 [00:17<00:00, 58.34it/s]Feature extracting:  97%|█████████▋| 1110/1145 [00:17<00:00, 55.98it/s]Feature extracting:  97%|█████████▋| 1116/1145 [00:18<00:00, 52.79it/s]Feature extracting:  98%|█████████▊| 1122/1145 [00:18<00:00, 50.12it/s]Feature extracting:  99%|█████████▊| 1128/1145 [00:18<00:00, 48.19it/s]Feature extracting:  99%|█████████▉| 1133/1145 [00:18<00:00, 47.72it/s]Feature extracting:  99%|█████████▉| 1138/1145 [00:18<00:00, 47.80it/s]Feature extracting: 100%|█████████▉| 1144/1145 [00:18<00:00, 49.56it/s]Feature extracting: 100%|██████████| 1145/1145 [00:19<00:00, 59.99it/s]
Feature extracting:   0%|          | 0/407 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/407 [00:00<06:32,  1.03it/s]Feature extracting:   3%|▎         | 12/407 [00:01<00:26, 15.00it/s]Feature extracting:   5%|▍         | 19/407 [00:01<00:16, 23.05it/s]Feature extracting:   6%|▋         | 26/407 [00:01<00:13, 27.78it/s]Feature extracting:   8%|▊         | 32/407 [00:01<00:12, 31.23it/s]Feature extracting:   9%|▉         | 37/407 [00:01<00:10, 33.78it/s]Feature extracting:  10%|█         | 42/407 [00:01<00:10, 35.46it/s]Feature extracting:  12%|█▏        | 47/407 [00:01<00:09, 36.76it/s]Feature extracting:  13%|█▎        | 52/407 [00:01<00:09, 37.74it/s]Feature extracting:  14%|█▍        | 57/407 [00:02<00:08, 38.99it/s]Feature extracting:  15%|█▌        | 62/407 [00:02<00:08, 39.35it/s]Feature extracting:  16%|█▋        | 67/407 [00:02<00:08, 39.63it/s]Feature extracting:  18%|█▊        | 72/407 [00:02<00:08, 39.82it/s]Feature extracting:  19%|█▉        | 77/407 [00:02<00:08, 39.95it/s]Feature extracting:  20%|██        | 82/407 [00:02<00:07, 41.50it/s]Feature extracting:  21%|██▏       | 87/407 [00:02<00:07, 41.30it/s]Feature extracting:  23%|██▎       | 92/407 [00:02<00:07, 40.80it/s]Feature extracting:  24%|██▍       | 97/407 [00:03<00:07, 40.30it/s]Feature extracting:  25%|██▌       | 102/407 [00:03<00:07, 40.43it/s]Feature extracting:  26%|██▋       | 107/407 [00:03<00:07, 40.83it/s]Feature extracting:  28%|██▊       | 112/407 [00:03<00:07, 40.30it/s]Feature extracting:  29%|██▊       | 117/407 [00:03<00:07, 40.32it/s]Feature extracting:  30%|██▉       | 122/407 [00:03<00:07, 40.48it/s]Feature extracting:  31%|███       | 127/407 [00:03<00:06, 41.19it/s]Feature extracting:  32%|███▏      | 132/407 [00:03<00:06, 41.30it/s]Feature extracting:  34%|███▎      | 137/407 [00:04<00:06, 42.25it/s]Feature extracting:  35%|███▍      | 142/407 [00:04<00:06, 43.33it/s]Feature extracting:  36%|███▌      | 147/407 [00:04<00:05, 43.96it/s]Feature extracting:  37%|███▋      | 152/407 [00:04<00:05, 45.40it/s]Feature extracting:  39%|███▊      | 157/407 [00:04<00:05, 45.12it/s]Feature extracting:  40%|███▉      | 162/407 [00:04<00:05, 45.01it/s]Feature extracting:  41%|████      | 167/407 [00:04<00:05, 44.84it/s]Feature extracting:  42%|████▏     | 172/407 [00:04<00:05, 44.66it/s]Feature extracting:  43%|████▎     | 177/407 [00:04<00:05, 44.54it/s]Feature extracting:  45%|████▍     | 182/407 [00:05<00:04, 45.68it/s]Feature extracting:  46%|████▌     | 187/407 [00:05<00:04, 45.29it/s]Feature extracting:  47%|████▋     | 192/407 [00:05<00:04, 44.96it/s]Feature extracting:  48%|████▊     | 197/407 [00:05<00:04, 44.73it/s]Feature extracting:  50%|████▉     | 202/407 [00:05<00:04, 44.58it/s]Feature extracting:  51%|█████     | 207/407 [00:05<00:04, 45.94it/s]Feature extracting:  52%|█████▏    | 213/407 [00:05<00:04, 47.49it/s]Feature extracting:  54%|█████▍    | 219/407 [00:05<00:03, 48.73it/s]Feature extracting:  55%|█████▌    | 225/407 [00:05<00:03, 49.19it/s]Feature extracting:  57%|█████▋    | 230/407 [00:06<00:03, 49.08it/s]Feature extracting:  58%|█████▊    | 236/407 [00:06<00:03, 50.00it/s]Feature extracting:  59%|█████▉    | 242/407 [00:06<00:03, 50.90it/s]Feature extracting:  61%|██████    | 248/407 [00:06<00:03, 51.84it/s]Feature extracting:  62%|██████▏   | 254/407 [00:06<00:02, 52.32it/s]Feature extracting:  64%|██████▍   | 260/407 [00:06<00:02, 50.87it/s]Feature extracting:  65%|██████▌   | 266/407 [00:06<00:02, 49.04it/s]Feature extracting:  67%|██████▋   | 271/407 [00:06<00:02, 47.27it/s]Feature extracting:  68%|██████▊   | 276/407 [00:06<00:02, 45.73it/s]Feature extracting:  69%|██████▉   | 281/407 [00:07<00:02, 44.55it/s]Feature extracting:  70%|███████   | 286/407 [00:07<00:02, 43.88it/s]Feature extracting:  71%|███████▏  | 291/407 [00:07<00:02, 43.98it/s]Feature extracting:  73%|███████▎  | 296/407 [00:07<00:02, 43.28it/s]Feature extracting:  74%|███████▍  | 301/407 [00:07<00:02, 42.84it/s]Feature extracting:  75%|███████▌  | 306/407 [00:07<00:02, 42.53it/s]Feature extracting:  76%|███████▋  | 311/407 [00:07<00:02, 42.79it/s]Feature extracting:  78%|███████▊  | 316/407 [00:07<00:02, 43.42it/s]Feature extracting:  79%|███████▉  | 321/407 [00:08<00:01, 43.49it/s]Feature extracting:  80%|████████  | 326/407 [00:08<00:01, 43.34it/s]Feature extracting:  81%|████████▏ | 331/407 [00:08<00:01, 43.26it/s]Feature extracting:  83%|████████▎ | 336/407 [00:08<00:01, 43.20it/s]Feature extracting:  84%|████████▍ | 341/407 [00:08<00:01, 43.59it/s]Feature extracting:  85%|████████▌ | 346/407 [00:08<00:01, 43.64it/s]Feature extracting:  86%|████████▌ | 351/407 [00:08<00:01, 43.64it/s]Feature extracting:  87%|████████▋ | 356/407 [00:08<00:01, 43.54it/s]Feature extracting:  89%|████████▊ | 361/407 [00:08<00:01, 43.42it/s]Feature extracting:  90%|████████▉ | 366/407 [00:09<00:00, 44.04it/s]Feature extracting:  91%|█████████ | 371/407 [00:09<00:00, 43.95it/s]Feature extracting:  92%|█████████▏| 376/407 [00:09<00:00, 44.12it/s]Feature extracting:  94%|█████████▎| 381/407 [00:09<00:00, 44.11it/s]Feature extracting:  95%|█████████▍| 386/407 [00:09<00:00, 44.20it/s]Feature extracting:  96%|█████████▌| 391/407 [00:09<00:00, 44.59it/s]Feature extracting:  97%|█████████▋| 396/407 [00:09<00:00, 44.50it/s]Feature extracting:  99%|█████████▊| 401/407 [00:09<00:00, 43.89it/s]Feature extracting: 100%|█████████▉| 406/407 [00:09<00:00, 43.44it/s]Feature extracting: 100%|██████████| 407/407 [00:10<00:00, 39.25it/s]
Feature extracting:   0%|          | 0/407 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/407 [00:01<07:11,  1.06s/it]Feature extracting:   1%|          | 4/407 [00:01<01:35,  4.22it/s]Feature extracting:   2%|▏         | 7/407 [00:01<00:53,  7.48it/s]Feature extracting:   2%|▏         | 10/407 [00:01<00:37, 10.59it/s]Feature extracting:   3%|▎         | 13/407 [00:01<00:29, 13.28it/s]Feature extracting:   4%|▍         | 16/407 [00:01<00:25, 15.50it/s]Feature extracting:   5%|▍         | 19/407 [00:01<00:22, 17.29it/s]Feature extracting:   5%|▌         | 22/407 [00:01<00:20, 18.69it/s]Feature extracting:   6%|▌         | 25/407 [00:02<00:19, 19.98it/s]Feature extracting:   7%|▋         | 28/407 [00:02<00:18, 20.63it/s]Feature extracting:   8%|▊         | 31/407 [00:02<00:17, 20.96it/s]Feature extracting:   8%|▊         | 34/407 [00:02<00:17, 21.18it/s]Feature extracting:   9%|▉         | 37/407 [00:02<00:16, 21.80it/s]Feature extracting:  10%|▉         | 40/407 [00:02<00:16, 21.75it/s]Feature extracting:  11%|█         | 43/407 [00:02<00:16, 21.85it/s]Feature extracting:  11%|█▏        | 46/407 [00:03<00:16, 22.17it/s]Feature extracting:  12%|█▏        | 49/407 [00:03<00:15, 22.62it/s]Feature extracting:  13%|█▎        | 52/407 [00:03<00:15, 22.71it/s]Feature extracting:  14%|█▎        | 55/407 [00:03<00:15, 22.55it/s]Feature extracting:  14%|█▍        | 58/407 [00:03<00:15, 22.74it/s]Feature extracting:  15%|█▍        | 61/407 [00:03<00:15, 22.87it/s]Feature extracting:  16%|█▌        | 64/407 [00:03<00:14, 23.24it/s]Feature extracting:  16%|█▋        | 67/407 [00:03<00:14, 23.35it/s]Feature extracting:  17%|█▋        | 70/407 [00:04<00:14, 23.40it/s]Feature extracting:  18%|█▊        | 73/407 [00:04<00:14, 23.65it/s]Feature extracting:  19%|█▊        | 76/407 [00:04<00:13, 23.86it/s]Feature extracting:  20%|█▉        | 80/407 [00:04<00:12, 26.36it/s]Feature extracting:  20%|██        | 83/407 [00:04<00:11, 27.21it/s]Feature extracting:  21%|██▏       | 87/407 [00:04<00:11, 27.98it/s]Feature extracting:  22%|██▏       | 90/407 [00:04<00:11, 28.48it/s]Feature extracting:  23%|██▎       | 94/407 [00:04<00:10, 29.68it/s]Feature extracting:  24%|██▍       | 98/407 [00:05<00:10, 29.68it/s]Feature extracting:  25%|██▌       | 102/407 [00:05<00:09, 31.37it/s]Feature extracting:  26%|██▋       | 107/407 [00:05<00:08, 34.59it/s]Feature extracting:  27%|██▋       | 111/407 [00:05<00:08, 35.95it/s]Feature extracting:  29%|██▊       | 116/407 [00:05<00:08, 36.32it/s]Feature extracting:  30%|██▉       | 121/407 [00:05<00:07, 38.49it/s]Feature extracting:  31%|███       | 125/407 [00:05<00:07, 36.03it/s]Feature extracting:  32%|███▏      | 129/407 [00:05<00:07, 34.99it/s]Feature extracting:  33%|███▎      | 133/407 [00:06<00:08, 33.82it/s]Feature extracting:  34%|███▎      | 137/407 [00:06<00:08, 33.72it/s]Feature extracting:  35%|███▍      | 141/407 [00:06<00:07, 33.65it/s]Feature extracting:  36%|███▌      | 145/407 [00:06<00:07, 33.84it/s]Feature extracting:  37%|███▋      | 149/407 [00:06<00:07, 33.39it/s]Feature extracting:  38%|███▊      | 153/407 [00:06<00:07, 33.83it/s]Feature extracting:  39%|███▊      | 157/407 [00:06<00:07, 34.07it/s]Feature extracting:  40%|███▉      | 161/407 [00:06<00:07, 33.35it/s]Feature extracting:  41%|████      | 165/407 [00:06<00:07, 32.96it/s]Feature extracting:  42%|████▏     | 169/407 [00:07<00:07, 32.89it/s]Feature extracting:  43%|████▎     | 173/407 [00:07<00:07, 32.85it/s]Feature extracting:  43%|████▎     | 177/407 [00:07<00:06, 33.75it/s]Feature extracting:  44%|████▍     | 181/407 [00:07<00:06, 33.78it/s]Feature extracting:  45%|████▌     | 185/407 [00:07<00:06, 33.62it/s]Feature extracting:  46%|████▋     | 189/407 [00:07<00:06, 33.57it/s]Feature extracting:  47%|████▋     | 193/407 [00:07<00:06, 33.19it/s]Feature extracting:  48%|████▊     | 197/407 [00:07<00:06, 33.92it/s]Feature extracting:  49%|████▉     | 201/407 [00:08<00:06, 33.20it/s]Feature extracting:  50%|█████     | 205/407 [00:08<00:06, 31.43it/s]Feature extracting:  51%|█████▏    | 209/407 [00:08<00:06, 30.11it/s]Feature extracting:  52%|█████▏    | 213/407 [00:08<00:06, 29.69it/s]Feature extracting:  53%|█████▎    | 216/407 [00:08<00:06, 29.08it/s]Feature extracting:  54%|█████▍    | 219/407 [00:08<00:06, 28.93it/s]Feature extracting:  55%|█████▍    | 222/407 [00:08<00:06, 28.58it/s]Feature extracting:  55%|█████▌    | 225/407 [00:08<00:06, 28.51it/s]Feature extracting:  56%|█████▌    | 228/407 [00:09<00:06, 28.68it/s]Feature extracting:  57%|█████▋    | 231/407 [00:09<00:06, 28.69it/s]Feature extracting:  57%|█████▋    | 234/407 [00:09<00:06, 28.67it/s]Feature extracting:  58%|█████▊    | 237/407 [00:09<00:05, 28.37it/s]Feature extracting:  59%|█████▉    | 240/407 [00:09<00:05, 28.20it/s]Feature extracting:  60%|█████▉    | 243/407 [00:09<00:05, 27.34it/s]Feature extracting:  60%|██████    | 246/407 [00:09<00:05, 27.44it/s]Feature extracting:  61%|██████    | 249/407 [00:09<00:05, 26.98it/s]Feature extracting:  62%|██████▏   | 252/407 [00:09<00:05, 26.44it/s]Feature extracting:  63%|██████▎   | 255/407 [00:10<00:05, 25.98it/s]Feature extracting:  63%|██████▎   | 258/407 [00:10<00:05, 25.68it/s]Feature extracting:  64%|██████▍   | 261/407 [00:10<00:05, 25.60it/s]Feature extracting:  65%|██████▍   | 264/407 [00:10<00:05, 25.49it/s]Feature extracting:  66%|██████▌   | 267/407 [00:10<00:05, 25.41it/s]Feature extracting:  66%|██████▋   | 270/407 [00:10<00:05, 25.50it/s]Feature extracting:  67%|██████▋   | 274/407 [00:10<00:04, 27.20it/s]Feature extracting:  68%|██████▊   | 278/407 [00:10<00:04, 29.04it/s]Feature extracting:  69%|██████▉   | 282/407 [00:10<00:04, 29.99it/s]Feature extracting:  70%|███████   | 286/407 [00:11<00:04, 30.22it/s]Feature extracting:  71%|███████▏  | 290/407 [00:11<00:03, 30.51it/s]Feature extracting:  72%|███████▏  | 294/407 [00:11<00:03, 31.40it/s]Feature extracting:  73%|███████▎  | 298/407 [00:11<00:03, 31.08it/s]Feature extracting:  74%|███████▍  | 302/407 [00:11<00:03, 31.31it/s]Feature extracting:  75%|███████▌  | 306/407 [00:11<00:03, 29.42it/s]Feature extracting:  76%|███████▌  | 309/407 [00:11<00:03, 28.44it/s]Feature extracting:  77%|███████▋  | 312/407 [00:12<00:03, 27.63it/s]Feature extracting:  77%|███████▋  | 315/407 [00:12<00:03, 26.90it/s]Feature extracting:  78%|███████▊  | 318/407 [00:12<00:03, 25.89it/s]Feature extracting:  79%|███████▉  | 321/407 [00:12<00:03, 25.22it/s]Feature extracting:  80%|███████▉  | 324/407 [00:12<00:03, 24.92it/s]Feature extracting:  80%|████████  | 327/407 [00:12<00:03, 24.31it/s]Feature extracting:  81%|████████  | 330/407 [00:12<00:03, 23.98it/s]Feature extracting:  82%|████████▏ | 333/407 [00:12<00:03, 23.37it/s]Feature extracting:  83%|████████▎ | 336/407 [00:13<00:03, 23.27it/s]Feature extracting:  83%|████████▎ | 339/407 [00:13<00:02, 23.06it/s]Feature extracting:  84%|████████▍ | 342/407 [00:13<00:02, 22.83it/s]Feature extracting:  85%|████████▍ | 345/407 [00:13<00:02, 22.62it/s]Feature extracting:  86%|████████▌ | 348/407 [00:13<00:02, 22.46it/s]Feature extracting:  86%|████████▌ | 351/407 [00:13<00:02, 22.81it/s]Feature extracting:  87%|████████▋ | 354/407 [00:13<00:02, 22.75it/s]Feature extracting:  88%|████████▊ | 357/407 [00:13<00:02, 22.58it/s]Feature extracting:  88%|████████▊ | 360/407 [00:14<00:02, 22.34it/s]Feature extracting:  89%|████████▉ | 363/407 [00:14<00:01, 22.80it/s]Feature extracting:  90%|█████████ | 367/407 [00:14<00:01, 25.18it/s]Feature extracting:  91%|█████████ | 370/407 [00:14<00:01, 26.27it/s]Feature extracting:  92%|█████████▏| 373/407 [00:14<00:01, 26.66it/s]Feature extracting:  92%|█████████▏| 376/407 [00:14<00:01, 27.15it/s]Feature extracting:  93%|█████████▎| 379/407 [00:14<00:01, 27.53it/s]Feature extracting:  94%|█████████▍| 383/407 [00:14<00:00, 28.52it/s]Feature extracting:  95%|█████████▍| 386/407 [00:15<00:00, 28.40it/s]Feature extracting:  96%|█████████▌| 389/407 [00:15<00:00, 28.51it/s]Feature extracting:  96%|█████████▋| 392/407 [00:15<00:00, 28.87it/s]Feature extracting:  97%|█████████▋| 395/407 [00:15<00:00, 29.04it/s]Feature extracting:  98%|█████████▊| 400/407 [00:15<00:00, 34.16it/s]Feature extracting: 100%|█████████▉| 406/407 [00:15<00:00, 39.60it/s]Feature extracting: 100%|██████████| 407/407 [00:15<00:00, 25.83it/s]
Feature extracting:   0%|          | 0/1 [00:00<?, ?it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  1.04it/s]Feature extracting: 100%|██████████| 1/1 [00:01<00:00,  1.08s/it]
feature banks saved to ./output/stl10/svhn_backdoored_encoder/2024-01-05-17:09:46/feature_banks.pkl
Train Epoch: 1 	Loss: 2.023512
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 34.64966195451752, "epoch": 1}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 1}
Train Epoch: 2 	Loss: 1.812575
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 40.89966195451752, "epoch": 2}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 2}
Train Epoch: 3 	Loss: 1.671741
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 46.10479409956976, "epoch": 3}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 3}
Train Epoch: 4 	Loss: 1.559122
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 50.41487400122926, "epoch": 4}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 4}
Train Epoch: 5 	Loss: 1.470364
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 53.08082360172096, "epoch": 5}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 5}
Train Epoch: 6 	Loss: 1.402018
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 55.63537185003073, "epoch": 6}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 6}
Train Epoch: 7 	Loss: 1.344010
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 57.63675476336816, "epoch": 7}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 7}
Train Epoch: 8 	Loss: 1.295755
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 59.073448063921326, "epoch": 8}
{"metric": "Eval - Attack Success Rate (ASR)", "value": 100.0, "epoch": 8}
Train Epoch: 9 	Loss: 1.255675
{"metric": "Eval - Backdoored Accuracy (BA)", "value": 60.38337430854333, "epoch": 9}
