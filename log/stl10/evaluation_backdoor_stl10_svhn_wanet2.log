/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2023-12-30 15:22:02
当前时间： 2023-12-30 15:22:03
test_transform_stl10
Loaded from: output/stl10/svhn_backdoored_encoder/2023-12-16-21:03:18wanet/model_200.pth
Namespace(batch_size=256, color=0, data_dir='./data/stl10/', encoder_usage_info='stl10', epochs=200, gpu='3', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=1, lr=0.001, pretrained_encoder='./output/stl10/clean_encoder/model_1000.pth', pretraining_dataset='stl10', psnr=0.025, reference_file='./reference/stl10/one.npz', reference_label=0, results_dir='./output/stl10/svhn_backdoored_encoder/2023-12-16-21:03:18wanet/', saturation_hsv=1, seed=100, shadow_dataset='stl10', timestamp='2023-12-16-21:03:18', trigger_file='trigger/stl10/unet_filter.pt', value_hsv=1)
Predicting features
Feature extracting:   0%|          | 0/1145 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/1145 [00:00<08:37,  2.21it/s]Feature extracting:   4%|▍         | 43/1145 [00:00<00:11, 93.41it/s]Feature extracting:   8%|▊         | 96/1145 [00:00<00:05, 196.49it/s]Feature extracting:  12%|█▏        | 139/1145 [00:00<00:03, 255.46it/s]Feature extracting:  15%|█▌        | 177/1145 [00:00<00:03, 286.74it/s]Feature extracting:  20%|█▉        | 224/1145 [00:01<00:02, 325.40it/s]Feature extracting:  24%|██▍       | 272/1145 [00:01<00:02, 355.04it/s]Feature extracting:  28%|██▊       | 319/1145 [00:01<00:02, 384.73it/s]Feature extracting:  32%|███▏      | 366/1145 [00:01<00:01, 407.23it/s]Feature extracting:  36%|███▌      | 410/1145 [00:01<00:01, 415.18it/s]Feature extracting:  40%|███▉      | 456/1145 [00:01<00:01, 427.57it/s]Feature extracting:  44%|████▍     | 501/1145 [00:01<00:01, 421.52it/s]Feature extracting:  48%|████▊     | 546/1145 [00:01<00:01, 424.39it/s]Feature extracting:  52%|█████▏    | 590/1145 [00:01<00:01, 367.57it/s]Feature extracting:  55%|█████▌    | 634/1145 [00:02<00:01, 386.49it/s]Feature extracting:  59%|█████▉    | 680/1145 [00:02<00:01, 402.80it/s]Feature extracting:  64%|██████▍   | 731/1145 [00:02<00:00, 430.26it/s]Feature extracting:  68%|██████▊   | 776/1145 [00:02<00:00, 432.03it/s]Feature extracting:  72%|███████▏  | 820/1145 [00:02<00:00, 409.98it/s]Feature extracting:  75%|███████▌  | 863/1145 [00:02<00:00, 407.46it/s]Feature extracting:  79%|███████▉  | 908/1145 [00:02<00:00, 408.66it/s]Feature extracting:  83%|████████▎ | 950/1145 [00:02<00:00, 405.31it/s]Feature extracting:  87%|████████▋ | 991/1145 [00:02<00:00, 401.21it/s]Feature extracting:  90%|█████████ | 1032/1145 [00:02<00:00, 382.93it/s]Feature extracting:  94%|█████████▍| 1075/1145 [00:03<00:00, 395.90it/s]Feature extracting:  97%|█████████▋| 1116/1145 [00:03<00:00, 380.36it/s]Feature extracting: 100%|██████████| 1145/1145 [00:03<00:00, 339.11it/s]
Traceback (most recent call last):
  File "training_downstream_classifier.py", line 97, in <module>
    feature_bank_training, label_bank_training = predict_feature(args,model.f, train_loader)
  File "/home/hrzhang/projects/badencoder_filter/evaluation/nn_classifier.py", line 141, in predict_feature
    feature_bank = torch.cat(feature_bank, dim=0).contiguous()
RuntimeError: torch.cat(): expected a non-empty list of Tensors
