/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-14 23:30:00
当前时间： 2024-01-14 23:30:00
test_transform_cifar10_poisson_noise
Loaded from: output/cifar10/gtsrb_backdoored_encoder/2024-01-03-12:20:49/model_200.pth
Namespace(batch_size=512, color=0.0, data_dir='./data/cifar10/', encoder_usage_info='cifar10', epochs=200, gpu='0', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=10.0, lr=0.001, pretrained_encoder='./output/cifar10/clean_encoder/model_1000.pth', pretraining_dataset='cifar10', psnr=0.025, rand_init=True, reference_file='./reference/cifar10/priority.npz', reference_label=0, results_dir='./output/cifar10/gtsrb_backdoored_encoder/2024-01-03-12:20:49/', saturation_hsv=1, seed=100, shadow_dataset='cifar10', timestamp='2024-01-03-12:20:49', trigger_file='optimize_filter/trigger/cifar10/2023-12-20-23-18-29/ssim0.9855_psnr30.10_lp0.0166_wd0.066_color3.966.pt', value_hsv=1)
{'loss': -10.937400326286394, 'wd': 0.0027451146269197933, 'ssim': 0.995040121152229, 'psnr': 39.51698975710525, 'lp': 0.0001378494051414705, 'sim': -10.937400326286394, 'far': 0.0, 'color': 4.873316032370341}
Predicting features
Feature extracting:   0%|          | 0/613 [00:00<?, ?it/s]Feature extracting:   0%|          | 1/613 [00:01<14:22,  1.41s/it]Feature extracting:   4%|▍         | 26/613 [00:01<00:25, 23.36it/s]Feature extracting:   7%|▋         | 45/613 [00:01<00:13, 41.52it/s]Feature extracting:  10%|▉         | 61/613 [00:01<00:09, 57.48it/s]Feature extracting:  13%|█▎        | 79/613 [00:01<00:06, 76.80it/s]Feature extracting:  16%|█▌        | 97/613 [00:01<00:05, 95.42it/s]Feature extracting:  19%|█▉        | 117/613 [00:02<00:04, 109.91it/s]Feature extracting:  22%|██▏       | 133/613 [00:02<00:04, 119.66it/s]Feature extracting:  24%|██▍       | 149/613 [00:02<00:03, 123.14it/s]Feature extracting:  27%|██▋       | 164/613 [00:02<00:03, 120.52it/s]Feature extracting:  30%|██▉       | 183/613 [00:02<00:03, 137.31it/s]Feature extracting:  32%|███▏      | 199/613 [00:02<00:02, 139.87it/s]Feature extracting:  35%|███▌      | 215/613 [00:02<00:02, 137.56it/s]Feature extracting:  38%|███▊      | 230/613 [00:02<00:02, 140.37it/s]Feature extracting:  40%|███▉      | 245/613 [00:03<00:03, 121.73it/s]Feature extracting:  43%|████▎     | 261/613 [00:03<00:02, 124.71it/s]Feature extracting:  46%|████▌     | 282/613 [00:03<00:02, 145.33it/s]Feature extracting:  49%|████▊     | 298/613 [00:03<00:02, 139.80it/s]Feature extracting:  52%|█████▏    | 317/613 [00:03<00:02, 141.85it/s]Feature extracting:  54%|█████▍    | 333/613 [00:03<00:01, 145.82it/s]Feature extracting:  57%|█████▋    | 351/613 [00:03<00:01, 153.49it/s]Feature extracting:  60%|██████    | 370/613 [00:03<00:01, 162.08it/s]Feature extracting:  63%|██████▎   | 387/613 [00:03<00:01, 161.75it/s]Feature extracting:  66%|██████▌   | 404/613 [00:04<00:01, 151.98it/s]Feature extracting:  69%|██████▊   | 420/613 [00:04<00:01, 145.96it/s]Feature extracting:  71%|███████   | 435/613 [00:04<00:01, 143.32it/s]Feature extracting:  74%|███████▍  | 453/613 [00:04<00:01, 144.28it/s]Feature extracting:  77%|███████▋  | 472/613 [00:04<00:00, 155.30it/s]Feature extracting:  80%|███████▉  | 488/613 [00:04<00:00, 152.81it/s]Feature extracting:  82%|████████▏ | 504/613 [00:04<00:00, 152.46it/s]Feature extracting:  85%|████████▍ | 521/613 [00:04<00:00, 156.64it/s]Feature extracting:  88%|████████▊ | 539/613 [00:04<00:00, 162.07it/s]Feature extracting:  91%|█████████ | 557/613 [00:05<00:00, 166.76it/s]Feature extracting:  94%|█████████▎| 574/613 [00:05<00:00, 154.47it/s]Feature extracting:  96%|█████████▌| 590/613 [00:05<00:00, 147.05it/s]Feature extracting: 100%|█████████▉| 610/613 [00:05<00:00, 160.45it/s]Feature extracting: 100%|██████████| 613/613 [00:05<00:00, 110.82it/s]
Feature extracting:   0%|          | 0/198 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/198 [00:00<01:02,  3.14it/s]Feature extracting:   8%|▊         | 15/198 [00:00<00:04, 45.29it/s]Feature extracting:  13%|█▎        | 26/198 [00:00<00:02, 62.28it/s]Feature extracting:  22%|██▏       | 44/198 [00:00<00:01, 96.26it/s]Feature extracting:  31%|███       | 61/198 [00:00<00:01, 117.48it/s]Feature extracting:  40%|████      | 80/198 [00:00<00:00, 137.22it/s]Feature extracting:  48%|████▊     | 96/198 [00:00<00:00, 137.82it/s]Feature extracting:  58%|█████▊    | 115/198 [00:01<00:00, 151.72it/s]Feature extracting:  68%|██████▊   | 134/198 [00:01<00:00, 161.22it/s]Feature extracting:  77%|███████▋  | 152/198 [00:01<00:00, 161.11it/s]Feature extracting:  86%|████████▌ | 170/198 [00:01<00:00, 165.93it/s]Feature extracting:  94%|█████████▍| 187/198 [00:01<00:00, 158.34it/s]Feature extracting: 100%|██████████| 198/198 [00:01<00:00, 118.59it/s]
Feature extracting:   0%|          | 0/198 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/198 [00:00<01:22,  2.40it/s]Feature extracting:   8%|▊         | 15/198 [00:00<00:04, 36.94it/s]Feature extracting:  13%|█▎        | 26/198 [00:00<00:03, 55.97it/s]Feature extracting:  19%|█▉        | 38/198 [00:00<00:02, 72.91it/s]Feature extracting:  26%|██▋       | 52/198 [00:00<00:01, 91.45it/s]Feature extracting:  32%|███▏      | 64/198 [00:00<00:01, 95.58it/s]Feature extracting:  38%|███▊      | 76/198 [00:01<00:01, 99.28it/s]Feature extracting:  44%|████▍     | 88/198 [00:01<00:01, 100.23it/s]Feature extracting:  51%|█████     | 101/198 [00:01<00:00, 108.28it/s]Feature extracting:  57%|█████▋    | 113/198 [00:01<00:00, 106.51it/s]Feature extracting:  63%|██████▎   | 125/198 [00:01<00:00, 104.56it/s]Feature extracting:  71%|███████   | 140/198 [00:01<00:00, 115.74it/s]Feature extracting:  78%|███████▊  | 155/198 [00:01<00:00, 124.37it/s]Feature extracting:  85%|████████▍ | 168/198 [00:01<00:00, 123.19it/s]Feature extracting:  92%|█████████▏| 182/198 [00:01<00:00, 126.72it/s]Feature extracting:  99%|█████████▉| 197/198 [00:02<00:00, 130.74it/s]Feature extracting: 100%|██████████| 198/198 [00:02<00:00, 89.80it/s] 
Feature extracting:   0%|          | 0/1 [00:00<?, ?it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  2.88it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  2.35it/s]
feature banks saved to output/cifar10/gtsrb_backdoored_encoder/2024-01-03-12:20:49/feature_banks.pkl
