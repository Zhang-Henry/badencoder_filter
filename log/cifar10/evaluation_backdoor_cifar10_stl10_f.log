/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/hrzhang/anaconda3/envs/badencoder/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
当前时间： 2024-01-14 20:17:56
当前时间： 2024-01-14 20:17:57
test_transform_cifar10
Loaded from: output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:59/model_150.pth
Namespace(batch_size=512, color=0.0, data_dir='./data/cifar10/', encoder_usage_info='cifar10', epochs=200, gpu='5', hue_hsv=1, knn_k=200, knn_t=0.5, lambda1=1.0, lambda2=1.0, lightness=1, loss0=10.0, lr=0.001, pretrained_encoder='./output/cifar10/clean_encoder/model_1000.pth', pretraining_dataset='cifar10', psnr=0.025, rand_init=False, reference_file='./reference/cifar10/truck.npz', reference_label=0, results_dir='./output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:59/', saturation_hsv=1, seed=100, shadow_dataset='cifar10', timestamp='2023-12-25-20:38:59', trigger_file='optimize_filter/trigger/cifar10/2023-12-20-23-18-29/ssim0.9855_psnr30.10_lp0.0166_wd0.066_color3.966.pt', value_hsv=1)
{'loss': -10.86108519367336, 'wd': 0.0038765593787136766, 'ssim': 0.9928659710687461, 'psnr': 37.79910970471569, 'lp': 0.00016586187934849805, 'sim': -10.86108519367336, 'far': 0.0, 'color': 4.901120756090302}
Predicting features
Feature extracting:   0%|          | 0/79 [00:00<?, ?it/s]Feature extracting:   1%|▏         | 1/79 [00:01<01:53,  1.46s/it]Feature extracting:  33%|███▎      | 26/79 [00:01<00:02, 22.87it/s]Feature extracting:  63%|██████▎   | 50/79 [00:01<00:00, 47.10it/s]Feature extracting:  91%|█████████ | 72/79 [00:01<00:00, 70.75it/s]Feature extracting: 100%|██████████| 79/79 [00:01<00:00, 40.54it/s]
Feature extracting:   0%|          | 0/125 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/125 [00:00<00:57,  2.15it/s]Feature extracting:  21%|██        | 26/125 [00:00<00:01, 60.32it/s]Feature extracting:  42%|████▏     | 53/125 [00:00<00:00, 112.01it/s]Feature extracting:  60%|██████    | 75/125 [00:00<00:00, 138.20it/s]Feature extracting:  78%|███████▊  | 97/125 [00:00<00:00, 159.62it/s]Feature extracting:  95%|█████████▌| 119/125 [00:00<00:00, 174.71it/s]Feature extracting: 100%|██████████| 125/125 [00:01<00:00, 115.57it/s]
Feature extracting:   0%|          | 0/125 [00:00<?, ?it/s]Feature extracting:   1%|          | 1/125 [00:00<00:42,  2.91it/s]Feature extracting:  14%|█▎        | 17/125 [00:00<00:02, 48.28it/s]Feature extracting:  25%|██▍       | 31/125 [00:00<00:01, 73.86it/s]Feature extracting:  36%|███▌      | 45/125 [00:00<00:00, 92.14it/s]Feature extracting:  46%|████▋     | 58/125 [00:00<00:00, 102.51it/s]Feature extracting:  58%|█████▊    | 73/125 [00:00<00:00, 111.41it/s]Feature extracting:  69%|██████▉   | 86/125 [00:00<00:00, 112.26it/s]Feature extracting:  79%|███████▉  | 99/125 [00:01<00:00, 111.54it/s]Feature extracting:  90%|████████▉ | 112/125 [00:01<00:00, 116.63it/s]Feature extracting: 100%|██████████| 125/125 [00:01<00:00, 92.00it/s] 
Feature extracting:   0%|          | 0/1 [00:00<?, ?it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  2.98it/s]Feature extracting: 100%|██████████| 1/1 [00:00<00:00,  2.41it/s]
feature banks saved to output/cifar10/stl10_backdoored_encoder/2023-12-25-20:38:59/feature_banks.pkl
